(function(){lib._PAGE_EVENT.on("checkvip",function(){var a=lib.cookie.get("P01010");a&&(a=parseFloat(a)*1E3,a<=(new Date).getTime()&&lib.kit.util.jsLoad.request("http://passport."+lib.SITE_DOMAIN+"/apis/user/userSign.php",{GET:{cb:"sendUserSign"},onSuccess:function(a){lib.log("\u53d1\u9001http://passport."+lib.SITE_DOMAIN+"/apis/user/userSign.php\u6210\u529f\uff0c"+a)},onError:function(a){lib.log("\u53d1\u9001http://passport."+lib.SITE_DOMAIN+"/apis/user/userSign.php\u5931\u8d25\uff0c"+a)}}))})})();
(function(a,b,d){function e(a,d,e){lib.eventTarget.call(this);this.textInput=typeof a=="string"?b.getElementById(a):a;this.resultWrapper=null;this._dataApi=d;this.option=Object.extend(f,e);this._state=!1;this._timer=null;this.keyword=this.oldValue=this._query="";this._dataCache={};this._keySelecting=this._isnaving=!1;this._ifrCover=null}lib.html2Nodes=function(a){var d=b.createElement("div");d.innerHTML=a;return d.childNodes};var f={len:2,delayTime:200,isswfWrapper:!1,isJsSubmit:!0};(function(a,b){function d(){}
d.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new d;a.prototype.constructor=a})(e,lib.eventTarget);Object.extend(e.prototype,{_onBlur:function(){lib.log("sugest blur");this.stop()},_initTextInput:function(){var a=this;this.textInput.setAttribute("autocomplete","off");$(this.textInput).on("blur",this._onBlur.bind(this));$(this.textInput).on("keydown",function(b){b=lib.fixEvent(b);b=b.keyCode;b==27&&(a.stop(),a.close());if(b==40){if(a.isWrapperHidden())return;a._keySelecting=!0;a._state&&
a.stop();a.fire({type:"down"})}if(b==38){if(a.isWrapperHidden())return;a._keySelecting=!0;a._state&&a.stop();a.fire({type:"up"})}b==13&&(a.fire({type:"enter"}),a.option.isJsSubmit?(a.textInput.blur(),a._submitForm()):a._onBlur());if(b!=40&&b!=38)a._state||a.start(),a._keySelecting=!1})},init:function(){var a=this;this._initTextInput();this._initDom();this._initDataApi();this.initWinEvent();this.option.isswfWrapper&&($(b).on("click",function(b){b=lib.fixEvent(b);b.target!=a.textInput&&a.close()}),
$(b).on("keydown",function(b){b=lib.fixEvent(b);b.target!=a.textInput&&b.keyCode==9&&a.close()}))},_initDataApi:function(){var a=this;this._dataApi.on("receive",function(b){b.data&&b.data.length>0?a.open(a.cacheData(b.data,b.key)):(a.close(),(lib.ipad||lib.iphone)&&a.start(),a.fire({type:"empty"}))})},_initDom:function(){var a=this;this.resultWrapper=b.createElement("div");this.resultWrapper.style.width="500px";this.resultWrapper.style.height="500px";this.resultWrapper.style.position="absolute";this.resultWrapper.style.top=
"0px";this._hideWrapper();this.resultWrapper.style.visibility="hidden";b.body.appendChild(this.resultWrapper);$(this.resultWrapper).on("mouseover",function(){a._keySelecting=!0})},start:function(){this._state=!0;var a=this;this._timer=setTimeout(function(){a.upadteContent();a._timer=setTimeout(arguments.callee,a.option.delayTime)},this.option.delayTime)},stop:function(){this._state=!1;clearInterval(this._timer)},upadteContent:function(){var a=this._query=this.textInput.value;if(this.oldValue!==a)a.length<
this.option.len&&(this.stop(),this.close()),this._state&&this._dataCache[a]!==d&&!this._keySelecting?this.open(this._dataCache[a]):this._state&&a.length>=this.option.len&&!this._keySelecting&&this._dataApi.request(a),this.oldValue=a},cacheData:function(a,b){return this._dataCache[b]=a},open:function(a){var b=this;this.setPos();this.fire({type:"show",data:a});try{lib._PAGE_EVENT&&lib._PAGE_EVENT.on("rerender",function(){b._state=!0;b.setPos()})}catch(d){}},setText:function(a){this._keySelecting=!0;
this.textInput.value=this.keyword=a},setWrapperHtml:function(a){this.resultWrapper.innerHTML=a},reFocus:function(){this.textInput.focus();this.start()},setPos:function(){this.resultWrapper&&this._state&&this._setPos()},_setPos:function(){var a=lib.box.getPosition(this.textInput);this.resultWrapper.style.zIndex=1001;this.resultWrapper.style.width=this.textInput.offsetWidth+"px";this.resultWrapper.style.left=a.left+"px";this.resultWrapper.style.top=a.top+this.textInput.offsetHeight+"px";this.resultWrapper.style.visibility=
""},setEmpty:function(a){this.setWrapperHtml(a);this._setPos()},close:function(){this.fire({type:"close"});this.stop();this._hideWrapper()},_submitForm:function(){var a=this.textInput.form;if(a&&a.nodeName==="FORM"){var d=lib.Element.create("input");d.attr("type","hidden");d.attr("name","from");d.val("suggest");lib.$(a).append(d);b.createEvent?(d=b.createEvent("MouseEvents"),d.initEvent("submit",!0,!1),a.dispatchEvent(d)):b.createEventObject&&a.fireEvent("onsubmit")}},submitForm:function(){this._submitForm()},
iframeCover:function(){return lib.html2Nodes('<iframe border="0" frameBorder="0" style="display:none;" ></iframe>')[0]},initIfr:function(){if(lib.IE6||lib.IE7||lib.Maxthon)this._ifrCover=this.iframeCover(),b.body.appendChild(this._ifrCover)},coverIframe:function(a){var b=this._ifrCover.style;b.display="block";b.position="absolute";b.left=a.left+"px";b.top=a.top+"px";b.width=a.width+"px";b.height=a.height+"px";b.zIndex=999},showIfr:function(){if(lib.IE6||lib.IE7||lib.Maxthon){var a=$(this.resultWrapper).down("ul").box(),
b={};b.left=a.left;b.top=a.top;b.width=a.width;b.height=a.height;this.coverIframe(b)}},hideIfr:function(){if(lib.IE6||lib.IE7||lib.Maxthon)this._ifrCover.style.display="none"},reSizeWin:function(){this.setPos()},initWinEvent:function(){var b=this;lib.$(a).on("resize",function(){b.reSizeWin()})},_hideWrapper:function(){this.resultWrapper.style.visibility="hidden"},isWrapperHidden:function(){return this.resultWrapper.style.visibility=="hidden"},setWrapperCss:function(a){this.resultWrapper.style.cssText+=
";"+a}});a.lib=a.lib||{};lib.kit=lib.kit||{};lib.kit.suggest=e})(window,document);
$reg("lib.kit.UnderFrame",function(){lib.kit.UnderFrame={_frames:{},show:function(a,b){var d=lib.$("#"+a);if(d&&(b=b||{},!lib.ipad)){this._frames[a]||(this._frames[a]=lib.Element.create("iframe"),this._frames[a].attr("src","about:blank"),this._frames[a].attr("frameBorder","0"),this._frames[a].hide(),lib.$(document.body).append(this._frames[a]));var e=d.box();this._frames[a].css("position",b.position||"absolute");this._frames[a].css("zIndex",(b.zIndex||d.css("zIndex")-1).toString());this._frames[a].css("top",
(b.top||e.top)+"px");this._frames[a].css("left",(b.left||e.left)+"px");this._frames[a].css("width",(b.width||e.width)+"px");this._frames[a].css("height",(b.height||e.height)+"px");this._frames[a].show()}},hide:function(a){lib.$("#"+a)&&this._frames[a]&&this._frames[a].hide()}}});
(function(){(function(a,b){function d(){lib.eventTarget.call(this);this._script=null;this.isDirect=0}function e(a){h.location=a}function f(a,b){if(!a)return null;return a.nodeName.toLowerCase()==b?a:f(a.parentNode,b)}var g=new lib.kit.Url(location.href),h=a;g.getParam("pr")=="baidu"&&(h=top);$reg("lib.action",function(){});$reg("lib.component",function(){});var i=a.document,j=i.getElementById("suggestText");if(j){if(lib.IE6)lib._PAGE_EVENT.on("loginclose",function(){j&&j.focus();j&&j.blur()});d.inherits(lib.eventTarget);
Object.extend(d.prototype,{request:function(b){var d="http://suggest.video."+lib.SITE_DOMAIN+"/suggest",e=lib.component.login.getUserInfo(),f=e&&e.uid,h=lib.cookie.get("QC006"),e=navigator.userAgent.toLowerCase(),g=/ipad/.test(e)?21:/iphone os/.test(e)?31:11;this.request=lib.IE&&!lib.IE9?function(b){var e=this,l=i.getElementsByTagName("head")[0],k=null,j=encodeURIComponent(b.trim().toLowerCase());if(!this._script)k=i.createElement("script"),k.charset="utf-8",l.insertBefore(k,l.firstChild),this._script=
k;this._script.onreadystatechange=function(){(!k||!k.readyState||!(k.readyState!="loaded"&&k.readyState!="complete"))&&a.suggestResult&&e.fire({type:"receive",data:suggestResult.data,key:b})};this._script.src=d+"?key="+j+"&cb=suggestResult&rltnum=10&uid="+h+"&ppuid="+f+"&platform="+g}:function(a){var b=this,e=a.trim().toLowerCase();lib.kit.util.jsLoad.request(d,{GET:{cb:"suggestResult",key:e,rltnum:10,uid:h,ppuid:f,platform:g},onSuccess:function(d){b.fire({type:"receive",data:d,key:a})},onError:function(){lib.$("#j-suggestList").hide()}})};
return this.request(b)}});lib.component.suggest=function(){this._first=!0;this._targetitem=0;this._eleSearch=j;this._dataRequest=new d;this._searchForm="j-search-form";this._suggestList="j-suggestList";this._submitBtn="searchClick";this._searchBg="j-search-bg";this._noValue="\u8bf7\u8f93\u5165\u641c\u7d22\u5173\u952e\u8bcd\u2026";this.init=function(){this._cutRange=parseInt(this._eleSearch.getAttribute("j-cutrange")||"18");this.form=$("#"+this._searchForm);this._suggest=new lib.kit.suggest(this._eleSearch,
this._dataRequest,{len:1,isJsSubmit:!1,isswfWrapper:!0});this._suggest.init();this.initEvent()};this.initEvent=function(){var b=this;lib._PAGE_EVENT.on("suggest_event_focus",function(){var a=lib.$("#"+b._searchBg);a&&a.hasClass("srchDef")&&a.addClass("srchCur")});lib._PAGE_EVENT.on("suggest_event_blur",function(){var a=lib.$("#"+b._searchBg);a&&a.hasClass("srchDef")&&a.removeClass("srchCur")});this._suggest.on("down",this._keyDown.bind(this,"down"));this._suggest.on("up",this._keyDown.bind(this,"up"));
this._suggest.on("enter",this._keyDown_enter.bind(this));this._suggest.on("show",this._renderSuggest.bind(this));this._suggest.on("close",function(){lib.kit.UnderFrame.hide(b._suggestList)});this.form.on("submit",this._formSubmit.bind(this));var d=$("#"+this._submitBtn);if(d)d.on("click",function(d){d=a.event||d;lib.Event.stop(d);b._btnSubmitClick.call(b,d)});else lib.kit.slog.log({flag:"search",url:location.href});var e=$(this._eleSearch);e.on("focus",function(){b._noValue==b._eleSearch.value.trim()&&
e.val("");lib._PAGE_EVENT.fire({type:"suggest_event_focus"});e.css("color","")});lib.$(this._suggest.resultWrapper).on("click",this._mouseDown.bind(this))};this.close=function(){this._suggest.close()};this._btnSubmitClick=function(d){d=a.event||d;lib.Event.stop(d);lib._PAGE_EVENT.fire({type:"beforesearch",data:{keyword:this._eleSearch.value.trim()}});this._curr==-1||this._curr===b?this._eleSearch.value.trim()&&this._eleSearch.value.trim()!=this._noValue?e(["http://so."+lib.SITE_DOMAIN+"/so/q",encodeURIComponent(this._eleSearch.value),
"f_2"].join("_")+"?s="+new Date*1):(this._eleSearch.value=this._noValue,this._eleSearch.style.color="#a9a9a9",$("#"+this._submitBtn)[0].focus()):(d=this._result[this._curr].cname?"_ctg_"+encodeURIComponent(this._result[this._curr].cname):"",e(["http://so."+lib.SITE_DOMAIN+"/so/q",encodeURIComponent(this._eleSearch.value)+d,"f_1"].join("_")+"?s="+new Date*1))};this._formSubmit=function(d){var f=this,d=a.event||d;lib.Event.stop(d);lib._PAGE_EVENT.fire({type:"beforesearch",data:{keyword:this._eleSearch.value.trim()}});
var h=function(){if(this._result[this._curr]["j-alias"]||this._result[this._curr]["j-link"])e(this._result[this._curr]["j-firstLink"]?this._result[this._curr]["j-firstLink"]:this._result[this._curr]["j-link"]);else{var a=this._result[this._curr].cname?"_ctg_"+encodeURIComponent(this._result[this._curr].cname):"";e(["http://so."+lib.SITE_DOMAIN+"/so/q",encodeURIComponent(this._eleSearch.value)+a,"f_1"].join("_")+"?s="+new Date*1)}};this._curr==-1||this._curr===b?this._eleSearch.value.trim()&&this._eleSearch.value.trim()!=
this._noValue?e(["http://so."+lib.SITE_DOMAIN+"/so/q",encodeURIComponent(this._eleSearch.value),"f_2"].join("_")+"?s="+new Date*1):(this._eleSearch.value=this._noValue,this._eleSearch.style.color="#a9a9a9",$("#"+this._submitBtn)[0].focus()):this._result[this._curr].is_series?this._targetitem=="2"?e(this._result[this._curr]["j-link"]):lib.action.NewPlayHistory.instance.getAlbum(this._result[this._curr].aid,function(a){a&&a.videoUrl?this._targetitem=="0"?e(a.videoUrl+"?key="+j.value+"&from=suggest&clicked=-"+
a.videoName+"\u64ad\u653e\u8bb0\u5f55"):this._targetitem=="1"&&e(this._result[this._curr]["j-link"]):h.call(f)}.bind(this)):h.call(f)};this.submitLog=function(a){lib.log(a);lib.log(this.suggestAll);lib.log(this.level4cnt);lib.log(this.isDirect);lib.kit.slog.log({flag:"suggest",suggestAll:this.suggestAll,level4cnt:this.level4cnt,level:a.level,keyword:a.name,isDirect:this.isDirect,cname:encodeURIComponent(a.cname)},"http://msg.video.qiyi.com/sev2.gif")};this._keyDown=function(a){var b=lib.$("#"+this._suggestList);
if(b&&(b=b.down("a"),b.length>0))this._curr=a=="down"?this._curr+1>b.length-1?0:this._curr+1:this._curr-1<0?b.length-1:this._curr-1,this._setSelected(this._curr),this._suggest.setText(this._result[this._curr].name)};this._keyDown_enter=function(){this._curr&&this._curr!=-1&&this.submitLog(this._result[this._curr])};this._mouseDown=function(b){var d=this,b=a.event||b;lib.Event.stop(b);var h=b.target||b.srcElement,h=f(h,"a");lib.$(h).attr("_index")!==null&&this._setSelected(parseInt(lib.$(h).attr("_index")));
this._mouseDownEx(h);var g=function(){if(h.getAttribute("j-link")&&h.getAttribute("j-link")!=="")e(h.getAttribute("j-link"));else{var a=h.getElementsByTagName("span")[0],b=h.getAttribute("title");d._suggest.textInput.value=b!==""?b:a.innerHTML;a=h.getAttribute("j_ctg");d._setChannelParam(a);d._suggest.submitForm()}};if(h.getAttribute("j-series"))if(this._targetitem=="2")e(this._result[this._curr]["j-link"]);else{lib.action.NewPlayHistory.instance.getAlbum(h.getAttribute("j-aid"),function(a){a&&a.videoUrl?
this._targetitem=="0"?e(a.videoUrl+"?key="+j.value+"&from=suggest&clicked=-"+a.videoName+"\u64ad\u653e\u8bb0\u5f55"):this._targetitem=="1"&&e(h.getAttribute("j-link")):g()}.bind(this));return}g()};this._mouseDownEx=function(a){this.submitLog(this._result[a.getAttribute("_index")])};this._renderSuggest=function(b){var d=this,e={tv:{first:"\u6700\u65b0\u4e00\u96c6",suffix:"\u5267\u96c6\u9875"},com:{first:"\u6700\u65b0\u4e00\u96c6",suffix:"\u5267\u96c6\u9875"},"var":{first:"\u6700\u65b0\u4e00\u671f",
suffix:"\u4e13\u9898"},tr:{first:"\u6700\u65b0\u4e00\u671f",suffix:"\u4e13\u9898"},doc:{first:"\u6700\u65b0\u4e00\u671f",suffix:"\u4e13\u9898"},art:{first:"\u6700\u65b0\u4e00\u96c6",suffix:"\u4e13\u9898"},fasvar:{first:"\u6700\u65b0\u4e00\u671f",suffix:"\u4e13\u9898"}};this._curr=-1;this._result=b.data;var b=[],f=[];this.isDirect=0;this.suggestAll=this._result.length;for(var h=0;h<this._result.length;h++)if(this._result[h].level=="4"?f.push(this.getCurrentContext(h,e)):b.push(this.getCurrentContext(h,
e)),h==0&&!this._result[0].added&&(this._result[0].recentLink!==""||this._result[0].firstLink!=="")&&this._addChildList(this._result[0].type),this._result[h]["j-alias"])this.isDirect=1;this.level4cnt=f.length;var e=f.length>0?b.length>0?'<div style="border-top:1px solid #ccc; padding-top:5px; margin:5px 0;">'+f.join("")+"</div>":f.join(""):"",g=lib.$(this._suggest.resultWrapper).box().width;if(g<200){var f=lib.$("#"+this._submitBtn),i=28,j=0;if(f)i=f.box().width,j=f.attr("_wsign")-0;this._suggest.resultWrapper.style.width=
g+i+j+"px"}this._suggest.setWrapperHtml("<div id='"+this._suggestList+"' class='suggest_t' style='top:0px;left:0px;width:100%;'>"+b.join("")+e+"</div>");lib.kit.UnderFrame.show(this._suggestList);if(this._first)lib.$(a).on("resize",function(){if(lib.$(d._suggest.resultWrapper).css("visibility")!="hidden")this._suggest.resultWrapper.style.width=g+i+j+"px",lib.kit.UnderFrame.show(d._suggestList),lib.log("resize")}.bind(this)),this._first=!1};this.getCurrentContext=function(a,b){var d=this._result[a],
e=0,f=!!d["j-alias"],h=f?d["j-alias"]:d.name,g=[];if(f)g.push('<a href="#" '+(a===this._curr?'class="selected otherH"':'class="otherH"')+(d.is_series?'j-series="'+d.is_series+'" ':"")+(d.aid?'j-aid="'+d.aid+'" ':"")+' _index="'+a+'" j-link="'+d["j-link"]+'" style="cursor:pointer;" '+(d.cuted?'title="'+d.name+(b[d.type].suffix||"\u4e13\u9898")+'"':'title="'+d["j-alias"].slice(d["j-alias"].indexOf(d["j-alias"].match(/<*\/span>/))+7)+'"')+' j_ctg="'+d.cname+'">'),g.push('<p _index="'+a+'" class="fL txtindex"><span _index="'+
a+'" class="focus-item">'+h+"</span></p>");else{d.count=d.count?d.count+"":d.count;if(d.cname.length==2&&(e=h.getLen()>=(this._cutRange-1)*2?this._cutRange*2-3:0,d.type=="en"||d.type=="trail"||d.type=="level4"))e=h.getLen()>=(this._cutRange-2)*2?(this._cutRange-1)*2-2:0;d.cname.length==3&&(e=h.getLen()>=(this._cutRange-1)*2?(this._cutRange-1)*2-3:0);d.cname.length==4&&(e=h.getLen()>=(this._cutRange-2)*2?(this._cutRange-1)*2-3:0);d.cname||(e=h.getLen()>=this._cutRange?this._cutRange*2:0);d.cname.length>
4&&(e=(this._cutRange-2)*2-d.cname.length);f="";if(d.adInfo)f=' href="'+d.adLink+'" j-link="'+d.adLink+'" ',d["j-link"]=d.adLink;d.link&&(d["j-link"]=d.link+"?key="+j.value+"&from=suggest&clicked="+d.name);d.firstLink&&(d["j-firstLink"]=d.firstLink+"?key="+j.value+"&from=suggest&clicked=-"+d.name);g.push('<a href="#" '+(d.is_series?'j-series="'+d.is_series+'" ':"")+(d.aid?'j-aid="'+d.aid+'" ':"")+(d.firstLink&&(d.type=="tv"||d.type=="com"||d.type=="doc")?'j-link="'+d["j-firstLink"]+'" ':d["j-link"]?
'j-link="'+d["j-link"]+'" ':"")+(a===this._curr?'class="selected"':"")+f+' _index="'+a+'" style="cursor:default;" title="'+h+'" j_ctg="'+d.cname+'">');g.push('<p _index="'+a+'" class="fL"><span _index="'+a+'" style="float:left" class="focus-item">'+(e==0?h:h.trancate(e,".."))+"</span>"+(d.cname?'<span _index="'+a+'" style="float:left">('+(d.cname=="\u5a31\u4e50"?"\u5a31\u4e50":d.cname)+")</span>":"")+((d.type=="en"||d.type=="trail"||d.type=="level4")&&d.link==""?'<span _index="'+a+'" style="float:right; padding-right:6px">'+
d.count+"\u4e2a</span>":"")+"</p>")}g.push("</a>");return g.join("")};this._trancate=function(a){return a};this._addChildList=function(a){var b={tv:{first:"\u66f4\u65b0\u81f3",suffix:"\u5267\u96c6\u9875"},com:{first:"\u66f4\u65b0\u81f3",suffix:"\u5267\u96c6\u9875"},"var":{first:"\u6700\u65b0\u4e00\u671f",suffix:"\u4e13\u9898"},tr:{first:"\u6700\u65b0\u4e00\u671f",suffix:"\u4e13\u9898"},doc:{first:"\u6700\u65b0\u4e00\u671f",suffix:"\u4e13\u9898"},art:{first:"\u6700\u65b0\u4e00\u96c6",suffix:"\u4e13\u9898"},
fasvar:{first:"\u6700\u65b0\u4e00\u671f",suffix:"\u4e13\u9898"}};if(this._result[0].link!=""&&b[a]){this.isDirect=1;var d=this._cloneObject(this._result[0]),e=null,e=d.name,f=e.getLen()>=(this._cutRange-1)*2?(this._cutRange-1)*2-3:0;d["j-alias"]="<span class='linec'>-</span>"+(f==0?e:e.trancate(f,".."))+(b[a].suffix||"\u4e13\u9898");d["j-link"]=this._result[0].link+"?key="+j.value+"&from=suggest&clicked=-"+e+(b[a].suffix||"\u4e13\u9898");d.cuted=f>0;this._result.splice(1,0,d);d=function(a){var b=
[];if(a.type=="var"||a.type=="fasvar"){var d=parseInt(a.tvSeason,10),e=parseInt(a.tvPhase,10),f=parseInt(a.update,10);if(d||e||f)b.push("(\u7b2c"),e?d?b.push(d,"\u5b63 \u7b2c",e):b.push(e):b.push(function(a){a=a.match(/.{2}/g);return a[0]+a[1]+(a[2]?"-"+a[2]:"")+(a[3]?"-"+a[3]:"")}(a.update)),b.push("\u671f)")}else a.update&&b.push("(",a.update,")");return b.join("")}(this._result[0]);this._result[0].recentLink!==""&&(e=this._cloneObject(this._result[0]),e["j-alias"]="<span class='linec'>-</span>"+
b[a].first+d,e["j-link"]=this._result[0].recentLink+"?key="+j.value+"&from=suggest&clicked=-"+b[a].first+d,this._result.splice(1,0,e));this._result[0].recentLink===""&&this._result[0].firstLink!==""&&(e=this._cloneObject(this._result[0]),e["j-alias"]="<span class='linec'>-</span>\u89c2\u770b\u7b2c\u4e00\u96c6",e["j-link"]=this._result[0].firstLink+"?key="+j.value+"&from=suggest&clicked=-\u89c2\u770b\u7b2c\u4e00\u96c6",this._result.splice(1,0,e));this._result[0].added=!0}};this._cloneObject=function(a){var b=
{};Object.extend(b,a);return b};this._setSelected=function(a){var b=i.getElementById(this._suggestList).getElementsByTagName("a");lib.$(b[this._targetitem]).removeClass("selected");this._targetitem=a;lib.$(b[a]).addClass("selected");this._curr=a};this._setChannelParam=function(a){var b=lib.Element.create("input");b.attr("type","hidden");b.attr("name","category");this.form.append(b);b.val(a)}};g=new lib.component.suggest;g.init();a.oldSuggest=g}})(window)})();
(function(a){var b=$("#suggestText"),d="";b&&(d=b.attr("suggestWord")||"",$reg("lib.jobs.suggest",function(){var e=Object.extend(lib.jobs.suggest,{testDefault:function(){var e=b.val();return(e==d||!e)&&!(a.sManager&&sManager.oldKey==d)},setDefault:function(){b.val()==""&&(b.css("color","#a9a9a9"),b.val(d))}});b.on("focus",function(){e.testDefault()&&b.val("");b.css("color","");lib._PAGE_EVENT.fire({type:"suggest_event_focus"})}).on("blur",function(){lib._PAGE_EVENT.fire({type:"suggest_event_blur"});
e.testDefault()&&e.setDefault()});(new lib.kit.Url(a.location.href)).getParam("key")===""&&e.setDefault()}))})(window,document);
(function(a){var b=!1,d=null,e,f,g,h,i,j,k;lib.component.HeaderPopup={init:function(){var b=this;(new lib.kit.Monitor(function(){e=lib.$("#j-username");f=lib.$("#j-user-popup");g=lib.$("#j-header");if(!e||!f||!g)return!1;e.on("click",b._clickHandler.bind(b));$(a).on("resize",b._pos.bind(b));lib.ipad||(e.on("mouseover",b._userOver.bind(b)),e.on("mouseout",b._userOut.bind(b)),f.on("mouseover",b._popupOver.bind(b)),f.on("mouseout",b._popupOut.bind(b)))},{time:100})).start()},destroy:function(){e&&(e.un("click",
this._clickHandler.bind(this)),e.un("mouseover",this._userOver.bind(this)),e.un("mouseout",this._userOut.bind(this)),f.un("mouseover",this._popupOver.bind(this)),f.un("mouseout",this._popupOut.bind(this)))},_show:function(){f.show();this._pos()},_pos:function(){h=e.box();i=g.box();j=i.top+i.height;k=h.left+h.width;f.css("top",j+"px");f.css("left",k-f.box().width+21+"px");lib.kit.UnderFrame.show("j-user-popup")},_hide:function(){f.hide();lib.kit.UnderFrame.hide("j-user-popup")},_clickHandler:function(a){lib.Event.preventDefault(a);
lib.ipad&&(b?(this._hide(),b=!1,lib.action.ipadPlayer&&lib.action.ipadPlayer.showVideo()):(this._show(),b=!0,lib.action.ipadPlayer&&lib.action.ipadPlayer.hideVideo()))},_userOver:function(){d!==null&&clearTimeout(d);b!==!0&&(this._show(),b=!0)},_userOut:function(){var a=this;b===!0&&(d=setTimeout(function(){a._hide();b=!1},100))},_popupOver:function(){d!==null&&clearTimeout(d)},_popupOut:function(){var a=this;b===!0&&(d=setTimeout(function(){a._hide();b=!1},100))}}})(window);
lib.model.userState=lib.model({crossDomain:!0,actions:{get:{method:"get",params:["cid","platform"],format:"json",encode:!0,passport:!0,url:"qv.action"}},url:"http://serv.vip."+lib.SITE_DOMAIN+"/services/"});
$reg("lib.action.UserState",function(){lib.action.UserState=Class.create({initialize:function(){},isVip:function(a){var b=window.qiyueChannelId,d="11",d=lib.realIpad?"21":lib.iphone?"31":"11";lib.model.userState.get(b?{cid:b,platform:d}:void 0,{success:function(b){a.success&&a.success(b)},failure:function(b){a.failure&&a.failure(b)}})}})});
(function(){var a=document.getElementById("j-login-wrapper");if(a){$reg("lib.tpl",function(){});lib.tpl.menu=['<div class="head_popup" id="j-user-popup" style="width:105px;display:none;z-index:999;"><ul class="head_ul qitan_UL">','<li id="j-iqiyi"><a href="http://i.'+lib.SITE_DOMAIN+'" target="_blank">\u6211\u7684\u5947\u827a</a></li>','<li class="qitan_msg" id="j-notice" style="display:none;"></li><li class="" id="j-qtsns"><a href="http://t.qiyi.com/" target="_blank" j-delegate="startwatcher">\u5947\u8c08\u793e\u533a</a></li><li class="qitan_msg" id="j-qtmsg-wrapper" style="display:none;"></li>',
'<li><a href="http://i.'+lib.SITE_DOMAIN+'/dingyue?navi" target="_blank">\u6211\u7684\u8ba2\u9605</a></li>','<li id="j-member"><a href="http://serv.vip.'+lib.SITE_DOMAIN+'/order/guide.action?pid=a0226bd958843452&cid=afbe8fd3d73448c9&platform=b6c13e26323c537d&fc=a988b1d4503873af">\u5f00\u901a\u4f1a\u5458</a></li>','<li><a href="http://i.'+lib.SITE_DOMAIN+'/shezhi" target="_blank">\u5e10\u53f7\u8bbe\u7f6e</a></li>','<li class="liLast"><a j-delegate="logout" href="http://passport.'+lib.SITE_DOMAIN+'/user/logout.php">\u5b89\u5168\u9000\u51fa</a></li>',
'</ul><span class="arraw"></span></div>'].join("");lib._PAGE_EVENT.on("checkvip",function(){if(lib.component.login.vipInfo){var a=lib.$("#j-member a");a&&lib.$(a[0]).html("\u7eed\u8d39\u4f1a\u5458")}});$reg("lib.component",function(){});$reg("lib.__callbacks__",function(){});lib.component.login={};var b=null;Object.extend(lib.component.login,{renderTopbar:function(){var d=this.getUserInfo(),e="";if(this.isLogin()){if(!lib.$("#j-username")){var f=d.email||"",e=(e=d.nickname||"")||f.trancate(8,"..")||
d.uid||"",e=e.trancate(5,"")+"..";a.innerHTML='<a href="http://vip.qiyi.com" target="_blank" onfocus="this.blur();"><img id="j-usericon" style="display:inline;margin-top:-2px;*margin-top:0;" src="http://www.qiyipic.com/common/fix/qiyue_images/userInfo.png"/></a><a id="j-username" class="head_more" href="#"><span>'+e+"</span></a>&nbsp;";b=document.getElementById("j-usericon");b.title="\u60a8\u8fd8\u6ca1\u6709\u5f00\u901a\u5947\u827a\u4f1a\u5458\uff0c\u7acb\u5373\u5f00\u901a\u4eab\u53d7\u4f1a\u5458\u5c0a\u8d35\u7279\u6743\u3002";
this._createMenuHTML(d);this._checkVip()}}else document.getElementById("j-username")&&($("#j-username").un("mouseover",this.createHTML),lib.component.HeaderPopup.destroy()),a.innerHTML='<a href="http://passport.'+lib.SITE_DOMAIN+"/register/reg.php?url="+(lib.PROJECT_REG_URL||"")+'" target="_blank">\u6ce8\u518c</a><span class="gline">|</span><a j-delegate="login" href="http://passport.'+lib.SITE_DOMAIN+'/user/login.php">\u767b\u5f55</a>',a.className="color55"},_createMenuHTML:function(a){if(!document.getElementById("j-user-popup")){var b=
new lib.Template(lib.tpl.menu);$(document.body).html("beforeend",b.evaluate({uid:a.uid}));lib.component.HeaderPopup.init()}},removeUserMenu:function(){var a=$("#j-user-popup");a&&a.remove()},_checkVip:function(){if(lib.action&&lib.action.UserState){var a=this;(new lib.action.UserState).isVip({success:function(e){(a.vipCB||function(){}).call(this,e);b.src="http://www.qiyipic.com/common/fix/qiyue_images/huiyuanInfo.png";b.title=e.type=="prepay"?"\u60a8\u5df2\u662f\u5947\u827a\u4f1a\u5458(\u6709\u6548\u671f\u81f3"+
e.deadline+")":"\u60a8\u5df2\u662f\u5947\u827a\u4f1a\u5458(\u624b\u673a\u5305\u6708\u4f1a\u5458)";a.vipInfo=e;a.isExpire=!1;lib._PAGE_EVENT.fire({type:"checkvip"})},failure:function(e){(a.notVipCB||function(){}).call(this);e.code=="Q00324"?(a.isExpire=!0,a.vipInfo=e.data,b.src="http://www.qiyipic.com/common/fix/qiyue_images/huiyuanOverdueInfo.png",b.title="\u60a8\u7684\u5947\u827a\u4f1a\u5458\u5df2\u8fc7\u671f\uff0c\u65e0\u6cd5\u7ee7\u7eed\u4eab\u53d7\u4f1a\u5458\u7684\u7279\u6743\u3002"):a.vipInfo=
!1;lib._PAGE_EVENT.fire({type:"checkvip"})}})}}})}})(window);
$reg("lib.kit.Dialog",function(){lib.kit.Dialog=function(a){lib.eventTarget.call(this);this.options=Object.extend({autoOpen:!0,content:"",contentSelector:"",modal:!0,context:window},a);this.options.contextDoc=this.options.context.document;this._create()};lib.kit.Dialog.inherits(lib.eventTarget);Object.extend(lib.kit.Dialog.prototype,{template:'<div style="display: none;width:${width}px;"class="j-dialog j-widget-content j-corner-all ${dialogClass}" tabindex="-1"><div class="j-dialog-titlebar j-widget-header j-corner-all j-helper-clearfix" unselectable="on"style="-moz-user-select: none;"><span class="j-dialog-title" unselectable="on" style="-moz-user-select: none;">${title}</span><a href="#" class="j-dialog-close j-corner-all" unselectable="on" style="-moz-user-select: none;"><span class="j-icon j-icon-closethick" unselectable="on" style="-moz-user-select: none;"></span></a></div><div class="j-dialog-content j-widget-content"></div><div class="j-dialog-buttonpane j-widget-content j-helper-clearfix"></div></div>',buttonTemplate:new lib.Template('<a href="#" class="inputBtn2" onclick="return false;">${text}</a>'),
_create:function(){var a=this,b=a.options,d,e,f=b.content,g=b.contentSelector;$(b.contextDoc.body).append(d=a.uiDialog=$(lib.Element.create("div").html((new lib.Template(b.template||a.template)).evaluate(b))[0].firstChild).css("position","absolute").css("zIndex",b.zIndex||100).on("keydown",function(d){b.closeOnEscape!==!1&&d.keyCode&&d.keyCode===27&&(a.close(d),lib.Event.preventDefault(d))}));e=a.content=d.down(".j-dialog-content");g?e.append($(g)):typeof f=="string"?e.html(f):e.append($(f));(e=d.down(".j-dialog-close"))&&
e.on("click",function(b){a.close(b);return!1});a.uiDialogTitlebar=d.down(".j-dialog-titlebar");b.draggable!==!1&&lib.kit.Draggable&&a._makeDraggable();b.buttons&&a._createButtons(b.buttons);this.onResize();a._isOpen=!1;b.modal||lib.kit.BgIframe.create(d);this.options.autoOpen&&this.open()},onResize:function(a){var b=this,a=a||{};lib.Event.on(this.options.context||window,"resize",b.onResize=function(){b._setPos(a.pos)})},_createButtons:function(a){var b=this,d=b.options,e=!1,f=b.uiDialog,g=f[0];b.uiDialogButtonPane=
f.down(".j-dialog-buttonpane");typeof a==="object"&&a!==null&&lib.each(a,function(){return!(e=!0)});if(e)(f=b.uiDialogButtonPane.down("*"))&&f.remove(),a.constructor==Object&&(a=[a]),b.buttons=[],lib.each(a,function(a){var e=$(lib.Element.create("div").html((d.buttonTemplate||b.buttonTemplate).evaluate(a))[0].firstChild).on("click",function(d){var e=a.fn;e&&e.constructor==Function&&e.apply(g,arguments);a.close&&b.close(d)});b.buttons.push(e);b.uiDialogButtonPane.append(e)}),b._initButtonEvents()},
open:function(){if(!this._isOpen){var a=this.options,b=this.uiDialog;this.overlay=a.modal?lib.kit.Overlay.create({context:a.context,zIndex:a.coverzIndex}):null;b.show();this._isOpen=!0;this._setPos(a.pos);(this.buttons||b)[0].focus();a.onOpen&&a.onOpen.apply(b[0]);return this}},close:function(a){if(this._isOpen){var b=this.options,d=b.onBeforeClose,e=b.onClose,f=this.uiDialog[0];if(!(d&&!1===d.call(f,a)))return this.overlay&&lib.kit.Overlay.destroy(this.overlay),this._isOpen=!1,b.destroyOnClose!==
!1?this.destroy():this.uiDialog.hide(),e&&e.call(f,a),this.release&&this.release(),this}},setContent:function(a){this.content.html(a)},_setPos:function(a){if(this._isOpen){var b,d=this.uiDialog,e=d.box();if(a&&a.top)b=a.top;else{b=e.height==0?180:e.height;var f=lib.box.getViewportHeight(this.options.context),g=lib.box.getPageScrollTop(this.options.context);b=b<f-30?(f-b)/2+g:g+30}a&&a.left?a=a.left:(a=e.width==0?180:e.width,a=(lib.box.getViewportWidth(this.options.context)-a)/2);d.css("top",b+"px");
d.css("left",a+"px");lib.kit.BgIframe.setBox(d);return this}},isOpen:function(){return this._isOpen},destroy:function(){this.overlay&&lib.kit.Overlay.destroy(this.overlay);lib.Event.un(this.options.context||window,"resize",this.onResize);this.options.contextDoc.body.removeChild(this.uiDialog[0]);return this},_makeDraggable:function(){var a=this.options,b=this.uiDialog,d=b[0],e=a.onDragStart,f=a.onDrag,g=a.onDragStop;if(a=this.uiDialogTitlebar)this.draggable=new lib.kit.Draggable({element:b,handle:a,
onStart:function(a){if(typeof e=="function")return e.call(d,a)},onDrag:function(a){if(typeof f=="function")return f.call(d,a)},onStop:function(a){lib.kit.Overlay.resize();if(typeof g=="function")return g.call(d,a)}}),b.addClass("j-draggable")},widget:function(){return this.uiDialog},option:function(a,b){var d=a,e=this;if(arguments.length===0)return Object.extend({},e.options);if(typeof a==="string"){if(b===void 0)return this.options[a];d={};d[a]=b}lib.each(d,function(a,b){e._setOption(b,a)});return e},
_setOption:function(a,b){var d=this.uiDialog;switch(a){case "buttons":this._createButtons(b);break;case "dialogClass":d.removeClass(this.options.dialogClass).addClass(b);break;case "draggable":b?this._makeDraggable():this.draggable.destroy();break;case "position":a="pos";this._setPos(b);break;case "title":$(".j-dialog-title",this.uiDialogTitlebar[0]).html(""+(b||"&#160;"))}this.options[a]=b},setPos:function(a,b){this._setOption("position",{top:a,left:b})},release:null})});
$reg("lib.kit.SimpleDialog",function(){lib.kit.SimpleDialog=function(a){lib.kit.Dialog.call(this,Object.extend({delegates:["ok","no"]},a))};lib.kit.SimpleDialog.inherits(lib.kit.Dialog);Object.extend(lib.kit.SimpleDialog.prototype,{_create:function(){var a=this.options;$(a.contextDoc.body).append(this.content=this.uiDialog=lib.Element.create("div").html(a.content).css("position","absolute").css("zIndex",a.zIndex||"111"));this.onResize();this._addDelegates();a.autoOpen&&this.open()},_setDelegates:function(a){if(a==
"")return this.options.delegates;this.options.delegates=a.match(/j\-delegate\=[\'|\"](.*?)[\'|\"]/gi).map(function(a){return a.match(/[\'|\"](.*?)[\'|\"]/)[1]})},_addDelegates:function(){var a=0,b=this.options.delegates,d=b.length;this.listDlg=[];for(var e=null;a<d;a++)e=this._cbdlg.bind(this,b[a]),this.listDlg.push(e),$(this.uiDialog).delegate(b[a],e)},_removeDelegates:function(){if(this.listDlg){for(var a=0,b=this.options.delegates,d=b.length,e=null;a<d;a++)e=this.listDlg[a],$(this.uiDialog).undelegate(b[a],
e);delete this.listDlg}},_cbdlg:function(a,b){this.fire({type:a,event:b.event})},show:function(a){this.setContent(a);this.open()},release:function(){this._removeDelegates()}})});
$reg("lib.kit.Overlay",function(){lib.kit.Overlay={options:null,instances:[],oldInstances:[],create:function(a){this.options=a=Object.extend({color:"#666666",opacity:50,context:window},a||{});var b=a.context.document;if(this.instances.length===0)lib.Event.on(a.context,"resize",this.resize);var d=a.opacity,a=(this.oldInstances.pop()||lib.Element.create("div",null,a.context).css("position","fixed").css("top","0px").css("left","0px")).css("width",this._getWidth()).css("height",this._getHeight()).css("backgroundColor",
a.color).css("filter","alpha(opacity="+d+")").css("opacity",d/100).css("zIndex",a.zIndex||10);lib.IE6&&a.css("position","absolute");$(b.body).append(a);lib.kit.BgIframe.create(a);this.instances.push(a);return a},resize:function(){var a=lib.kit.Overlay;lib.each(a.instances,function(b){b.css("width",0).css("height",0).css("width",a._getWidth()).css("height",a._getHeight());lib.kit.BgIframe.setBox(b)})},_getWidth:function(){var a=this.options.context.document,b;if(lib.IE6)return b=Math.max(a.documentElement.scrollWidth,
a.body.scrollWidth),a=Math.max(a.documentElement.offsetWidth,a.body.offsetWidth),b<a?lib.box.getViewportWidth(this.options.context)+"px":b+"px";else{if(lib.IE7||lib.IE8)return Math.max(a.documentElement.clientWidth,a.body.scrollWidth,a.documentElement.scrollWidth,a.body.offsetWidth)-1+"px";return Math.max(a.documentElement.clientWidth,a.body.scrollWidth,a.documentElement.scrollWidth,a.body.offsetWidth,a.documentElement.offsetWidth)+"px"}},_getHeight:function(){var a=this.options.context.document,
b;return lib.IE6?(b=Math.max(a.documentElement.scrollHeight,a.body.scrollHeight),a=Math.max(a.documentElement.offsetHeight,a.body.offsetHeight),b<a?lib.box.getViewportHeight(this.options.context)+"px":b+"px"):lib.box.getDocumentHeight(this.options.context)+"px"},destroy:function(a){var b=this.options.context;this.oldInstances.push(this.instances.splice(this.instances.index(a),1)[0]);this.instances.length===0&&lib.Event.un(b,"resize",this.resize);a=a[0];(b=a.parentNode)&&b.removeChild(a)}}});
$reg("lib.kit.BgIframe",function(){lib.kit.BgIframe={create:function(a){if(!lib.WEBKIT&&(lib.IE6||lib.Maxthon))a=$(a),a.down("iframe.bgiframe")||this.setBox(a.append(lib.Element.create('<iframe class="bgiframe"frameborder="0" tabindex="-1"src="javascript:false;"style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');top:0px;left:0px;"/>')))},setBox:function(a){var a=$(a),b=a.down("iframe.bgiframe");if(b){var d=a.box();lib.each(["width","height"],function(a){b.css(a,d[a]+"px")})}}}});
(function(a){a.kit=a.kit||{};kit.dialog=function(a){lib.eventTarget.call(this);this._option={model:!0,delegates:["ok","no"]};this.setOption(a)};kit.dialog.inherits(lib.eventTarget);Object.extend(kit.dialog.prototype,{show:function(a){lib.ipad||lib._PLAYER_WMODE_SP&&lib._PLAYER_WMODE_SP.show();if(this._option.model&&!this._cover)this._cover=lib.kit.Overlay.create({color:"#000",zIndex:400});this.box||(a.html?this.renderHTML(a.html):(a.src&&this.renderIfr(a),this.fire({type:"show"})))},setOption:function(a){Object.extend(this._option,
a||{})},renderHTML:function(a){var d=this._tempId="j-"+(new Date).getTime();$(document.body).html("beforeend","<div id="+d+">"+a+"</div>");this.box=$("#"+d)[0].firstChild;this._addDelegates()},_addDelegates:function(){var a=0,d=this._option.delegates,e=d.length;this.listDlg=[];for(var f=null;a<e;a++)f=this._cbdlg.bind(this,d[a]),this.listDlg.push(f),$(this.box).delegate(d[a],f)},_removeDelegates:function(){if(this.listDlg){for(var a=0,d=this._option.delegates,e=d.length,f=null;a<e;a++)f=this.listDlg[a],
$(this.box).undelegate(d[a],f);this.listDlg=null}},_cbdlg:function(a){this.fire({type:a})},setCenter:function(){lib.ui.viewCenter(this.box)},renderIfr:function(b){var d={src:"about:blank",width:580,height:375},e=document.getElementById("j-dialog"),f=this._tempId="j-"+(new Date).getTime();$(document.body).html("beforeend","<div id="+f+"></div>");Object.extend(d,b);e?(e.width=d.width,e.height=d.height,e.src=d.src):($(document.body).html("beforeend",'<iframe allowtransparency="true" id="j-dialog" src="'+
d.src+'" frameborder="0" scrolling="no" width="'+d.width+'" height="'+d.height+'" style="z-index:9999;"></iframe>'),e=document.getElementById("j-dialog"));this.box=e;lib.ui.viewCenter(this.box);this.__setCenter=this.setCenter.bind(this);var g=this;(lib.IE6||lib.IE7)&&lib._PAGE_EVENT&&lib._PAGE_EVENT.on("rerender",function(){if(lib.$("#j-dialog")&&g._cover)lib.$("#j-dialog")[0].style.display="block",lib.$("#j-dialog")[0].style.display=""});$(a).on("resize",this.__setCenter);if(lib.IE6)$(a).on("scroll",
this.__setCenter)},hide:function(){this.box.hide();this._cover&&lib.kit.Overlay.destroy(this._cover);this._cover=null},close:function(){lib.ipad||lib._PLAYER_WMODE_SP&&lib._PLAYER_WMODE_SP.hide();lib._PAGE_EVENT&&lib._PAGE_EVENT.fire({type:"loginclose"});var b=document.getElementById(""+this._tempId);if(b)this._cover&&lib.kit.Overlay.destroy(this._cover),$(this.box).remove(),this._removeDelegates(),this.fire({type:"close"}),this._cover=this.box=null,b&&$(b).remove(),this.__setCenter&&$(a).un("resize",
this.__setCenter),lib.IE6&&$(a).un("scroll",this.__setCenter)}})})(window);
(function(a,b){$reg("lib.component",function(){});$reg("lib.__callbacks__",function(){});var d=lib.component.login=lib.component.login||{};Object.extend(lib.component.login,{_loginList:[],_logoutList:[],dialog:null,show:function(a,d){var g={showClose:!0,regUrl:""};Object.extend(g,d||{});var h="",h="",h=function(){};h.isTemp=!0;a=a||h;if(this.isLogin())a();else{try{this.isExpire=this.vipInfo=b}catch(i){}this.clearTempCb();this.setCallback("login",a);h=(h=g.regUrl||lib.PROJECT_REG_URL)?"?url="+h+"&showclose=":
"?showclose=";h=g.btnId?h+"&btnid="+g.btnId:h;this.dialog.show({src:g.loginUrl||"http://passport."+lib.SITE_DOMAIN+"/user/loginiframe.php"+h+g.showClose})}},showOnce:function(a,b){a.isTemp=!0;this.show(a,b)},isLogin:function(){return lib.net.isLogin()},getUserInfo:function(){return lib.net.getUserInfo()},setCallback:function(a,b){a=="login"?this._loginList.indexOf(b)==-1&&this._loginList.push(b):this._logoutList.push(b)},runCallbacks:function(a,b){var d=this.getUserInfo();if({login:!0,logout:!0}[a]){for(var h=
this["_"+a+"List"].length,i=null,j=0;j<h;j++){i=this["_"+a+"List"][j];try{i(d,b)}catch(k){}}this.clearTempCb()}},logout:function(){$(document.body).html("beforeend",'<iframe id="j_logout_" src="http://passport.'+lib.SITE_DOMAIN+'/user/logout.php?noredirect=1&logoutcb=lib.__callbacks__.logout_callback" style="display:none;"></iframe>')},_dlgLogout:function(a){try{this.isExpire=this.vipInfo=b}catch(d){}lib.Event.preventDefault(a.event);lib.PROJECT_LOGOUT_ACTION?lib.go(lib.PROJECT_LOGOUT_ACTION):this.logout()},
_dlgLogin:function(a){lib.Event.preventDefault(a.event);a=a.target||a.srcElement;this.isLogin()?this.runCallbacks("login"):lib.component.login.show(null,{regUrl:a.getAttribute("data-regurl")||"",btnId:a.getAttribute("data-btnid")||""})},clearTempCb:function(){for(var a=this._loginList.length,b=null,d=0;d<a;d++)b=this._loginList[d],b.isTemp&&b.isTemp===!0&&this._loginList.splice(d,1)},init:function(){this.dialog=new kit.dialog;lib.PROJECT_LOGIN_COMPONENT=lib.component.login;this.renderTopbar&&this.renderTopbar();
$(document).delegate("login",this._dlgLogin.bind(this));$(document).delegate("logout",this._dlgLogout.bind(this))}});d.init();d.setCallback("login",function(){d.dialog.close();lib.PROJECT_LOGIN_RELOAD?lib.go(location.href):(d.renderTopbar&&d.renderTopbar(),lib._PAGE_EVENT.fire({type:"login"}))});d.setCallback("logout",function(){d.renderTopbar&&d.renderTopbar();lib.PROJECT_LOGOUT_RELOAD?lib.go(location.href):(lib.kit.UnderFrame&&lib.kit.UnderFrame.hide("j-user-popup"),setTimeout(function(){$("#j_logout_")&&
$("#j_logout_").remove();d.removeUserMenu&&d.removeUserMenu()},100),lib._PAGE_EVENT.fire({type:"logout"}))});lib.__callbacks__.login_success=function(a){var b=null;if(a.relogin){$(document.body).html("beforeend",'<iframe id="j_reLogin_" style="display:none;"></iframe>');var b=$("#j_reLogin_"),g=setTimeout(function(){try{lib.kit.slog.log({flag:"rl"})}catch(h){}d.runCallbacks("login",a);try{b.remove()}catch(g){}},5E3);b&&(b.on("load",function(){g&&clearTimeout(g);d.runCallbacks("login",a);setTimeout(function(){try{b.remove()}catch(a){}},
0)}),b.attr("src",a.relogin))}else d.runCallbacks("login",a)};lib.__callbacks__.login_error=function(){};lib.__callbacks__.logout_callback=function(){d.runCallbacks("logout")}})(window);lib.model.Bubble=lib.model({actions:{get:{method:"get",params:[],format:"json",encode:!0,passport:!1,url:"new_msg.php"},clear:{method:"get",params:[],format:"json",encode:!0,passport:!1,url:"clean_new_msg.php"}},url:"http://api.t."+lib.SITE_DOMAIN+"/api/common/"});
(function(){function a(){this._timer=null;this.isRunning=!1;this.delay=3E5}lib.action.watcher=a;Object.extend(a.prototype,{run:function(){throw"abstract method";},start:function(){(this._timer||this.isRunning)&&this.stop();this.isRunning=!0;this._timer=setInterval(this.run.bind(this),this.delay)},stop:function(){clearInterval(this._timer);this.isRunning=!1;this._timer=null}})})(this);
(function(){function a(){lib.action.watcher.call(this);$(document).delegate("startwatcher",this._startWatcher.bind(this));lib.component.login.setCallback("login",this._login.bind(this));lib.component.login.setCallback("logout",this.stop.bind(this))}if(lib.component&&lib.component.login){a.inherits(lib.action.watcher);Object.extend(a.prototype,{run:function(){lib.model.Bubble.get(null,{success:this._success.bind(this),failure:this._error.bind(this)})},_login:function(){this.run();this.start()},_startWatcher:function(){this.isRunning||
(this._resetState(),this.start())},_resetState:function(){try{lib._PAGE_EVENT.fire({type:"hasnewmsg",target:{}})}catch(a){}var b=$("#j-username span");if(b[0].className.indexOf("newMessage")!=-1)$("#j-notice").css("display","none"),$("#j-iqiyi")[0].className="",b[0].className="",$("#j-qtmsg-wrapper").css("display","none"),$("#j-qtsns")[0].className="",document.getElementById("j-user-popup").getElementsByTagName("li")[0].className=""},_success:function(a){if($("#j-username")){var b=$("#j-username span"),
f=[],g=lib.component.login.getUserInfo().uid,h=0,i=0,j=0,k=0,o=0;try{setTimeout(function(){lib._PAGE_EVENT.fire({type:"hasnewmsg",target:a})},5E3)}catch(l){}if(a.comment||a.atme||a.attention||a.msg||a.notice){if(this.stop(),b[0].className.indexOf("newMessage")==-1){b[0].className="newMessage";h=parseInt(a.msg);i=parseInt(a.atme);j=parseInt(a.comment);o=parseInt(a.attention);k=parseInt(a.notice);h>0&&f.push('<p><a href="http://t.qiyi.com/'+g+'/msg" target="_blank" j-delegate="startwatcher">-\u65b0\u79c1\u4fe1(<em>'+
this.parseNum(h)+"</em>)</a></p>");i>0&&f.push('<p><a href="http://t.qiyi.com/'+g+'/atme" target="_blank" j-delegate="startwatcher">-@\u6211\u7684(<em>'+this.parseNum(i)+"</em>)</a></p>");j>0&&f.push('<p><a href="http://t.qiyi.com/'+g+'/comment" target="_blank" j-delegate="startwatcher">-\u65b0\u56de\u590d(<em>'+this.parseNum(j)+"</em>)</a></p>");o>0&&f.push('<p><a href="http://t.qiyi.com/'+g+'/fans" target="_blank" j-delegate="startwatcher">-\u65b0\u7c89\u4e1d(<em>'+this.parseNum(o)+"</em>)</a></p>");
if(k>0)$("#j-notice").html('<p><a href="http://i.'+lib.SITE_DOMAIN+'/tongzhi" target="_blank" j-delegate="startwatcher">-\u901a\u77e5(<em>'+this.parseNum(k)+"</em>)</a></p>"),$("#j-notice").css("display",""),$("#j-iqiyi")[0].className="liLast";if(a.comment||a.atme||a.attention||a.msg)$("#j-qtmsg-wrapper").html(f.join("")),$("#j-qtmsg-wrapper").css("display",""),$("#j-qtsns")[0].className="liLast"}}else $("#j-qtmsg-wrapper").html(""),$("#j-qtmsg-wrapper").css("display","none"),$("#j-qtsns")[0].className=
""}},parseNum:function(a){return a>99?"99":a},_error:function(a){this.isRunning&&this.stop();var b=$("#j-qtmsg-wrapper");b&&b.css("display","none");lib.msg&&lib.log("newmsg"+(lib.msg[a.code]||""))}});var b=new a;lib.component.login.isLogin()&&(b.run(),b.start())}})(this);
$reg("lib.kit.serverTime",function(){lib.kit.serverTime={serverUrl:"http://passport."+lib.SITE_DOMAIN+"/apis/external/time.php",init:function(a){var a=a||lib.emptyMethod,b=this;lib.kit.util.jsLoad.request(this.serverUrl,{GET:{cb:"cb_"+Math.ceil(Math.random()*1E5).toString(36)},onSuccess:function(d){b.serTime=parseInt(d.time,10);b.locTime=parseInt(new Date/1E3,10);a(b.serTime)},onError:function(){b.serTime=b.locTime=parseInt(new Date/1E3,10);a(b.serTime)},timeout:3E3})},now:function(a){if(!isNaN(this.serTime*
1)&&!isNaN(this.locTime*1)){var b=parseInt(new Date/1E3,10)-this.locTime*1+this.serTime*1;if(a instanceof Function)a(b);else return b}else this.init(a)}}});
(function(){if(lib.ipad||lib.noFlashAndroid){lib.action.ipadPlayer={hideVideo:function(){var a=this,d=document.getElementById("video");if(d&&d.controls)var e=setInterval(function(){if(d&&d.parentNode.parentNode.id=="flashbox")d.pause(),d.style.display="none",clearInterval(e),document.getElementById("j-ipadhistoryshowcover")?document.getElementById("j-ipadhistoryshowcover").style.display="":a._createCanvas()},10)},showVideo:function(){var a=document.getElementById("video");if(a&&a.controls)var d=setInterval(function(){if(a&&
a.parentNode.parentNode.id=="flashbox"){if(document.getElementById("j-ipadhistoryshowcover"))document.getElementById("j-ipadhistoryshowcover").style.display="none";a.play();document.getElementById("video").style.display="";clearInterval(d)}},10)},_createCanvas:function(){var a=document.getElementById("video"),d=document.createElement("img");d.id="j-ipadhistoryshowcover";d.width=a.width;d.height=a.height;d.src=a.width==640?"http://www.qiyipic.com/common/fix/ipadcovernormal.png":"http://www.qiyipic.com/common/fix/ipadcoverwide.png";
document.getElementById("flashbox").appendChild(d)}};try{lib.component.login.dialog.on("show",function(){lib.action.ipadPlayer.hideVideo()}),lib.component.login.dialog.on("close",function(){lib.action.ipadPlayer.showVideo()})}catch(a){}}})(window);lib.reg("lib.view",function(){});lib.Class("View",{ns:lib.view,methods:{init:lib.abstractMethod,update:lib.abstractMethod}});
(function(){lib.Class("NewPlayHistoryView",{ns:lib.view,extend:lib.view.View,properties:{TERMINAL:{11:"\u7535\u8111",12:"\u7535\u8111",21:"\u5e73\u677f",22:"\u5e73\u677f",31:"\u624b\u673a",32:"\u624b\u673a",51:"\u7535\u89c6"},boxTpl:['<div id="j-clearing" class="bd ptop" style="background:#fff; width:268px; height:255px; position:absolute; top:15px; left:0; display:none; z-index:1;" ><div style="display:block" class="ui_loading"><img src="http://www.qiyipic.com/common/images/load.gif"><br /><br /><span>\u6b63\u5728\u4e3a\u60a8\u6e05\u7a7a\u64ad\u653e\u8bb0\u5f55</span></div></div><div id="j-clearWindow" class="bd ptop" style="background:#fff; width:268px; height:255px; position:absolute; top:15px; left:0; display:none; z-index:1;" ><div class="wrap-bg0"><div class="wrap-wid"><p>\u662f\u5426\u6e05\u7a7a\u60a8\u5728\u7535\u8111\u3001\u5e73\u677f\u7535\u8111\u3001\u624b\u673a\u3001\u7535\u89c6\u4e0a\u89c2\u770b\u7231\u5947\u827a\u7684\u5168\u90e8\u64ad\u653e\u8bb0\u5f55\uff1f</p><p class="tip"><input id="j-clearBtnOk" type="button" class="btn00 mr15" value="\u786e\u5b9a"><input id="j-clearBtnCancel" type="button" class="btn00" value="\u53d6\u6d88"></p></div></div></div><div class="hd"><a j-delegate="historyClose" class="close" onclick="return false" href="#">\u5173\u95ed</a><div id="j-historyClear" style="text-align:right; float:right; line-height:47px;"><a style="" j-delegate="clearHistory" onclick="return false" href="#">\u6e05\u7a7a\u8bb0\u5f55</a><span style="padding-left:5px; padding-right:8px;">|</span></div></div><div class="bd"><div id="j-historyNothing" class="none_jilu" style="display:none"><p>\u60a8\u6682\u65f6\u6ca1\u6709\u64ad\u653e\u8bb0\u5f55</p><ul>',
'<li id="j-readme"><span><a target="_blank" class="zhuce" href="http://passport.'+lib.SITE_DOMAIN+"/register/reg.php?url="+(lib.PROJECT_REG_URL||"")+'">\u6ce8\u518c</a>\u6210</span>\u7231\u5947\u827a\u7528\u6237\uff0c<span><a j-delegate="loginAndClose" class="denglu" href="http://passport.'+lib.SITE_DOMAIN+'/user/login.php">\u767b\u5f55</a>\u540e</span>\u5c06\u80fd\u6c38\u4e45\u4fdd\u5b58\u64ad\u653e\u8bb0\u5f55\u3002</li>','<li>\u64ad\u653e\u8bb0\u5f55\u5728\u7535\u8111\u3001\u5e73\u677f\u7535\u8111\u3001\u624b\u673a\u3001\u7535\u89c6\u4e0a\u89c2\u770b\u7231\u5947\u827a\u5185\u5bb9\u65f6\u4e92\u901a\u3002</li></ul><div id="j-wrongHelp" class="jilu_help">',
'<a href="http://www.'+lib.SITE_DOMAIN+'/common/helpandsuggest.html?entry=yedi#wenti16">\u64ad\u653e\u8bb0\u5f55\u603b\u8bb0\u5f55\u4e0d\u4e0a\u600e\u4e48\u529e\uff1f</a>','</div></div><div style="position:relative;overflow: hidden;"><ul id="j-historyUl"></ul><div id="j-historyMaskLoading" class="ui_loading" style="width:100%;height:100%;position:absolute;top:0;left:0;background-color:#ffffff;opacity:0.8;filter:alpha(opacity=80);display:none;"><img src="http://www.qiyipic.com/common/images/load.gif"><br /><span>\u6b63\u5728\u52aa\u529b\u83b7\u53d6\u5185\u5bb9..</span></div></div><div id="j-historyMiddleLoading" class="ui_loading"><img src="http://www.qiyipic.com/common/images/load.gif"><br /><span>\u6b63\u5728\u52aa\u529b\u83b7\u53d6\u5185\u5bb9..</span></div></div><div class="ft"><div id="j-historyImport" class="loaded" style="display:none"><a j-delegate="historyImportClose" title="\u5173\u95ed" href="#" onclick="return false" class="close">\u5173\u95ed</a><a j-delegate="historyImport" href="#" onclick="return false" class="nologin">\u70b9\u51fb\u5bfc\u5165\u672a\u767b\u5f55\u65f6\u7684\u64ad\u653e\u8bb0\u5f55</a><div style="display:none"><span class="daoru">\u5bfc\u5165\u5b8c\u6210</span>',
'<a href="http://i.'+lib.SITE_DOMAIN+'/bofangjilu" target="_blank">\u67e5\u770b\u5b8c\u6574\u64ad\u653e\u8bb0\u5f55>></a>','</div><div id="j-historyFootLoading" class="ui_loading" style="display:none"><img src="http://www.qiyipic.com/common/images/load.gif"><span>\u6b63\u5728\u52aa\u529b\u83b7\u53d6\u5185\u5bb9..</span></div></div><div id="j-readme2" class="loaded" style="display:none"><div><a j-delegate="readme2Close" class="close" onclick="return false" href="#" title="\u5173\u95ed">\u5173\u95ed</a>',
'<a j-delegate="loginAndClose" href="http://passport.'+lib.SITE_DOMAIN+'/user/login.php">\u767b\u5f55</a>\u540e\u5c06\u80fd\u6c38\u4e45\u4fdd\u5b58\u64ad\u653e\u8bb0\u5f55<span class="fgx_line">|</span>','<a target="_blank" href="http://passport.'+lib.SITE_DOMAIN+"/register/reg.php?url="+(lib.PROJECT_REG_URL||"")+'">\u514d\u8d39\u6ce8\u518c</a>','</div><div><a j-delegate="readme2Close" class="close" onclick="return false" href="#" title="\u5173\u95ed">\u5173\u95ed</a>\u7231\u5947\u827a\u7528\u6237\u5c06\u80fd\u6c38\u4e45\u4fdd\u5b58\u64ad\u653e\u8bb0\u5f55</div></div></div><div style="height:50px;width:100%;opacity:0;filter:alpha(opacity=0);background-color:#000000"></div>'].join(""),
listTpl:'<li ${currentPlayId}class="${on}"><div class="row"><h2 class="tit_other"><a tvid="${tvId}" href="${videoUrl}" title="${videoName}">${videoTrancateName}</a></h2><a j-delegate="historyDel" title="${remove}" href="#" onclick="return false" class="close">${remove}</a></div><div class="row row_new"><span class="info">${playState}</span><span class="info_R_New"><a title="${playCtl}" href="${videoPlayUrl}" class="continue">${playCtl}</a><em>${spliter}</em><a title="${playNext}" href="${videoPlayNextUrl}" class="continue">${playNext}</a></span></div></li>',
list2centerTpl:['<li class="add-tips">','<a href="http://i.'+lib.SITE_DOMAIN+'/bofangjilu" target="_blank">',"\u8fdb\u5165\u6211\u7684\u7231\u5947\u827a\u67e5\u770b\u5b8c\u6574\u64ad\u653e\u8bb0\u5f55&gt;&gt;</a></li>"].join(""),listBtn:$("#topT1"),listWrapper:lib.Element.create("div"),listWrapperId:"j-playHistoryWrapper",listWrapperStyle:"gui-PlayLogSuggest",showCurrent:!0,_ctrl:null,hideTimer:!1,isOpen:!1,importCloseTime:5E3,urlEx:{},pingbackEx:{},_haveData:!1,_hasOnEvent:!1},methods:{init:function(a){this._ctrl=
a;if(this.listBtn){if(!this._ctrl.isFinalPlayer())this.showCurrent=!1;this.listBtn.on("click",function(a){lib.Event.stop(a)});var a="?"+["pltfm="+(lib.ipad?"21":"11"),"furl="+(window.location.protocol+"//"+window.location.host+window.location.pathname)].join("&"),b="http://msg.video.qiyi.com/phtr.gif"+a;this.urlEx={nxtep:a+"&type=fltl&area=phtr&pos=nxtep",ctnvw:a+"&type=fltl&area=phtr&pos=ctnvw",revw:a+"&type=fltl&area=phtr&pos=revw",title:a+"&type=fltl&area=phtr&pos=title",enrperc:a+"&type=fltl&area=phtr&pos=enrperc"};
this.pingbackEx={show:b+"&act=show&type=fltl&url=",close:b+"&act=close&type=fltl&url=",dlt:b+"&act=dlt&type=fltl&url=",emy:b+"&act=emy&type=fltl&url=",imt:b+"&act=imt&type=fltl&url="};this._initWrapper();this._initMenuBox();this._initBindEvent();this._initEvent();this._initDelegate();this._initElement();this._initClearBox();this.listWrapper[0].attachEvent&&lib.IE7&&this.listWrapper[0].attachEvent("onmousewheel",function(){window.event.returnValue=!1});lib.swf.qiyiClearOK=this.initPlayerEvent.bind(this)}},
initPlayerEvent:function(){var a=this,b=function(){var b=lib.component.login.getUserInfo().uid;arguments.length>0&&(a.isOpen?a._ctrl.readHistory.call(a._ctrl,!0):a._ctrl.clearLastLoadTime(),lib.cookie.remove(a._ctrl.cookieName,"/",lib.SITE_DOMAIN),a._ctrl.notice2swf(b));b&&a._ctrl.getLocalHistory.call(a._ctrl).length>0&&lib.cookie.get(a._ctrl.cookieName)!=b?a._ctrl.openImport.call(a._ctrl):a._ctrl.closeImport.call(a._ctrl)};b();lib._PAGE_EVENT.on("logout",b);lib._PAGE_EVENT.on("login",b);window.onerror=
function(){return!0}},update:function(a){if(a.update===!0&&this[a.type]instanceof Function)this[a.type](a)},_initBindEvent:function(){this._listBtnOverBinded=this._listBtnOver.bind(this);this._listBtnOutBinded=this._listBtnOut.bind(this);this._listWrapperOverBinded=this._listWrapperOver.bind(this);this._listWrapperOutBinded=this._listWrapperOut.bind(this);this._listWrapperOutBinded=this._listWrapperOut.bind(this);this._setPosBinded=this._setPos.bind(this)},_initEvent:function(){this.onEvent()},onEvent:function(){this.listBtn.on("mouseover",
this._listBtnOverBinded);this.listBtn.on("mouseout",this._listBtnOutBinded);this.listWrapper.on("mouseover",this._listWrapperOverBinded);this.listWrapper.on("mouseout",this._listWrapperOutBinded);this._hasOnEvent=!0},unEvent:function(){this.listBtn.un("mouseover",this._listBtnOverBinded);this.listBtn.un("mouseout",this._listBtnOutBinded);this.listWrapper.un("mouseover",this._listWrapperOverBinded);this.listWrapper.un("mouseout",this._listWrapperOutBinded);this._hasOnEvent=!1},_initDelegate:function(){this.listWrapper.delegate("historyClose",
this._closeMenu.bind(this));this.listWrapper.delegate("clearHistory",this._openClearWindow.bind(this));this.listWrapper.delegate("historyDel",this._deleteHistory.bind(this));this.listWrapper.delegate("historyImportClose",this.closeImport.bind(this));this.listWrapper.delegate("historyImport",this.importHistory.bind(this));this.listWrapper.delegate("readme2Close",this.closeReadme2.bind(this));this.listWrapper.delegate("loginAndClose",function(a){lib.Event.stop(a.event);this._closeMenu.call(this);lib.component.login.show()}.bind(this))},
_initElement:function(){this._maskLoading=$("#j-historyMaskLoading");this._middleLoading=$("#j-historyMiddleLoading");this._footLoading=$("#j-historyFootLoading");this._nodata=$("#j-historyNothing");this._unorderedList=$("#j-historyUl");this._importBlock=$("#j-historyImport");this._helpTip=$("#j-wrongHelp");this._regTip=$("#j-readme").down("span");this._regTip2=$("#j-readme2");this._clearBtnWarrper=$("#j-historyClear");this._clearing=$("#j-clearing");this._clearWindow=$("#j-clearWindow");this._clearBtnOk=
$("#j-clearBtnOk");this._clearBtnCancel=$("#j-clearBtnCancel")},_initClearBox:function(){var a=this;this._clearBtnOk.on("click",function(){(new Image).src=a.pingbackEx.emy;a._clearWindow.hide();a._clearing.show();a._ctrl.clearHistory.call(a._ctrl)});this._clearBtnCancel.on("click",function(){a._clearWindow.hide();a.onEvent()})},listReady:function(a){this._clearLoading();this._setItem(a);if(!this._hasOnEvent)this.onEvent()},listError:function(){this._clearLoading();if(!this._hasOnEvent)this.onEvent()},
delReady:function(){this._clearLoading();this._ctrl.readHistory(!0)},delError:function(){this._clearLoading()},clearReady:function(){this._clearLoading();this._ctrl.readHistory(!0)},clearError:function(){this._clearLoading()},importReady:function(){var a=this;this._clearLoading("Foot");this._importBlock.down("a")[1].style.display="none";this._importBlock.down("div")[0].style.display="";this._ctrl.readHistory(!0);lib.cookie.set(this._ctrl.cookieName,lib.component.login.getUserInfo().uid,0,"/",lib.SITE_DOMAIN);
setTimeout(function(){a.closeImport.call(a)},a.importCloseTime)},importError:function(){this._clearLoading("Foot");this._importBlock.down("a")[0].style.display="";this._importBlock.down("a")[1].style.display="";this._importBlock.down("a")[1].innerHTML="\u672a\u80fd\u6210\u529f\u5bfc\u5165\u64ad\u653e\u8bb0\u5f55\u8bf7\u91cd\u8bd5"},openImport:function(){this._importBlock.down("a")[0].style.display="";this._importBlock.down("a")[1].style.display="";this._importBlock.down("a")[1].innerHTML="\u70b9\u51fb\u5bfc\u5165\u672a\u767b\u5f55\u65f6\u7684\u64ad\u653e\u8bb0\u5f55";
this._importBlock.down("div")[0].style.display="none";this._importBlock.show();this.isOpen&&this._setIframePos()},importHistory:function(){(new Image).src=this.pingbackEx.imt;this._importBlock.down("a")[0].style.display="none";this._importBlock.down("a")[1].style.display="none";this._ctrl.importHistory()},closeReadme2:function(){this._regTip2.down("div")[0].style.display=="none"?lib.cookie.set(this._ctrl.loginedFlag,"1",0,"/",lib.SITE_DOMAIN):lib.cookie.set(this._ctrl.unloginFlag,"1",0,"/",lib.SITE_DOMAIN);
this._regTip2.hide();this.isOpen&&this._setIframePos()},closeImport:function(){this._importBlock.hide();this.isOpen&&this._setIframePos();this._changeBottomTipMsg()},_clearLoading:function(a){if(a)this["_set"+a+"Loading"]("",!1);else this._setMaskLoading("",!1),this._setMiddleLoading("",!1),this._setFootLoading("",!1),this._setAllLoading("",!1)},setLoading:function(a){a=a.loading;this["_set"+a.position+"Loading"](a.loadMsg,a.ing)},_setItem:function(a){var b,d,e=new lib.Template(this.listTpl),f=[],
g=a.list.length;g>10&&(g=10);this._unorderedList[0].className=g>4?"max":"";b=this._ctrl.getCurrentInfo.call(this._ctrl);this.showCurrent&&b.videoName&&f.push(e.evaluate(this._getInfo(b)));for(var h=0;h<g;h++)this._ctrl.isFinalPlayer()&&a.list[h].tvId==b.tvId||(d=this._getInfo(a.list[h]),f.push(e.evaluate(d)));g>9&&lib.component.login.isLogin()&&f.push(this.list2centerTpl.replace("bofangjilu","bofangjilu"+this.urlEx.enrperc));g>1?this._clearBtnWarrper.css("display",""):this._clearBtnWarrper.css("display",
"none");f.join("")==""?(this._changeNodataMsg(),this._haveData=!1,this._nodata.css("display","")):(this._haveData=!0,this._nodata.css("display","none"));this._changeBottomTipMsg();this._unorderedList.html(f.join(""));this._itemInitEvent();this._unorderedList[0].scrollTop=0;this.isOpen&&this._setIframePos()},_itemInitEvent:function(){var a=this,b=this._unorderedList.down("li"),d=$("#j-historyCurrentPlay");if(this.showCurrent&&d&&(d=d.down(".tit_other").down("a")))d.on("click",function(a){lib.Event.stop(a)});
b&&b.each(function(b){if(b.attr("class")!="add-tips")b.on("mouseenter",a._itemOver.bind(a)).on("mouseleave",a._itemOut.bind(a))})},_changeNodataMsg:function(){lib.component.login.isLogin()?this._regTip.hide():this._regTip.css("display","");this._ctrl.isOpenFlashCookie.call(this._ctrl)?this._helpTip.hide():this._helpTip.css("display","")},_changeBottomTipMsg:function(){var a=this._regTip2.down("div"),b=!1;a.hide();if(this._haveData)lib.component.login.isLogin()?(a[1].style.display="",lib.cookie.get(this._ctrl.loginedFlag)||
(b=!0),this._importBlock.css("display")!="none"&&(b=!1)):(a[0].style.display="",lib.cookie.get(this._ctrl.unloginFlag)||(b=!0));b?this._regTip2.show():this._regTip2.hide();this.isOpen&&this._setIframePos()},_getInfo:function(a){a.videoUrl=a.videoUrl||window.location.protocol+"//"+window.location.host+window.location.pathname;a.currentPlayId="";var b=this._ctrl.getCurrentInfo.call(this._ctrl),d=isNaN(a.videoPlayTime)?-1:parseInt(a.videoPlayTime,10),e=Math.floor(d/60),f="",g="",h="",i=a.videoUrl,j=
a.tvId;this.showCurrent&&j==b.tvId?(a.currentPlayId='id="j-historyCurrentPlay" ',f="\u6b63\u5728\u64ad\u653e...",g="",h="\u5173\u95ed"):(f=this.TERMINAL[a.terminalId]?"["+this.TERMINAL[a.terminalId]+"]":"",h="\u5220\u9664",d<60&&d!=0?(f+="\u89c2\u770b\u4e0d\u8db31\u5206\u949f",i+=this.urlEx.ctnvw,g="\u7ee7\u7eed\u89c2\u770b"):d==0?(f+="\u5df2\u770b\u5b8c",g="\u91cd\u65b0\u89c2\u770b",i+=this.urlEx.revw):(f+="\u89c2\u770b\u81f3",e&&(f+=e+"\u5206\u949f"),i+=this.urlEx.ctnvw,g="\u7ee7\u7eed\u89c2\u770b"),
(a.channelId==2||a.channelId==4)&&a.nextTvid&&a.nextVideoUrl?(a.playNext="\u4e0b\u4e00\u96c6",a.spliter="|",a.videoPlayNextUrl=a.nextVideoUrl+this.urlEx.nxtep):(a.spliter="",a.playNext="",a.videoPlayNextUrl="#"));a.videoTrancateName=a.videoName.trancate(32,"..");a.videoPlayUrl=i;a.playState=f;a.playCtl=g;a.videoUrl+=this.urlEx.title;a.remove=h;a.tvId=j;return a},_initMenuBox:function(){new lib.Template(this.listTpl);var a=this.boxTpl.replace("bofangjilu","bofangjilu"+this.urlEx.enrperc);this.listWrapper.css("overflow",
"visible");this.listWrapper.html(a)},_initWrapper:function(){this.listBtn.box();this.listWrapper[0].id=this.listWrapperId;this.listWrapper[0].className=this.listWrapperStyle;this.listWrapper.css("position","absolute").css("zIndex",99999).css("visibility","hidden");document.body.insertBefore(this.listWrapper[0],null);this._setPos();lib.kit.UnderFrame.hide("j-playHistoryWrapper")},_setMiddleLoading:function(a,b){this._setLoading(this._middleLoading,a,b)},_setMaskLoading:function(a,b){this._setLoading(this._maskLoading,
a,b)},_setFootLoading:function(a,b){this._setLoading(this._footLoading,a,b)},_setAllLoading:function(a,b){this._setLoading(this._clearing,a,b)},_setLoading:function(a,b,d){a.css("display",d?"":"none");a.down("span").html(b)},_openClearWindow:function(){this.unEvent();this._clearWindow.show()},_showMenu:function(){(new Image).src=this.pingbackEx.show;this._ctrl.readHistory();this.listWrapper.css("visibility","");this._setPos();lib._PAGE_EVENT.on("rerender",this._setPosBinded)},_setPos:function(){var a=
lib.PROJECT_NAME=="qiyue"?!0:!1,b=this.listBtn.box();this.listWrapper.css("top",b.bottom-2+"px").css("left",b.left+(a&&info.qy_pt!=="P"&&info.qy_pt!=="S"?12:-3)+"px");this._setIframePos()},_setIframePos:function(){var a=this.listWrapper.box();try{lib.kit.UnderFrame.show("j-playHistoryWrapper",{top:a.top+8,left:a.left,width:a.width,height:a.height-58})}catch(b){}},_closeMenu:function(){if(arguments.length>0)(new Image).src=this.pingbackEx.close;lib._PAGE_EVENT.un("rerender",this._setPosBinded);this.listWrapper.css("visibility",
"hidden");lib.kit.UnderFrame.hide("j-playHistoryWrapper")},_listBtnOver:function(){if(this.hideTimer!==null)clearTimeout(this.hideTimer),this.hideTimer=null;if(this.isOpen!==!0)this._showMenu(),this.isOpen=!0},_listBtnOut:function(){var a=this;if(a.isOpen===!0)a.hideTimer=setTimeout(function(){a._closeMenu.call(a);a.isOpen=!1},100)},_listWrapperOver:function(){if(this.hideTimer!==null)clearTimeout(this.hideTimer),this.hideTimer=null},_listWrapperOut:function(){var a=this;if(a.isOpen===!0)a.hideTimer=
setTimeout(function(){a._closeMenu.call(a);a.isOpen=!1},100)},_itemOver:function(a){a=a||window.event;(a.currentTarget||a.srcElement).className="on"},_itemOut:function(a){a=a||window.event;(a.currentTarget||a.srcElement).className=""},_deleteHistory:function(a){var b=$(a.target).parent("li"),a=$(a.target).parent().down("h2").down("a");this._setMaskLoading("\u6b63\u5728\u4e3a\u60a8\u5220\u9664\u64ad\u653e\u8bb0\u5f55..",!0);b.un("mouseover").un("mouseenter").un("mouseleave").un("mouseout");(new Image).src=
this.pingbackEx.dlt+(a[0].protocol+"//"+a[0].host+a[0].pathname);a.attr("tvid")==this._ctrl.getCurrentInfo.call(this._ctrl).tvId&&this._ctrl.isFinalPlayer()?(this.showCurrent=!1,this._ctrl.refreshHistory()):this._ctrl.deleteHistory(a.attr("tvid"))},refreshCurrent:function(a,b,d){a=$("#j-historyCurrentPlay");this.showCurrent&&a&&(a=a.down(".tit_other").down("a"),a.attr("tvid",d).attr("title",b).html(b.trancate(32,"..")))},getClear:function(){return lib.action.ClearSwf.get()},getPlayer:function(){var a=
$("#"+this._ctrl.PLAYER_ID);return a&&a[0]}}})})();
(function(){lib.Class("PlayHistoryView",{ns:lib.view,extend:lib.view.NewPlayHistoryView,properties:{listWrapperStyle:"gui-PlayLogSuggest_wrap",boxTpl:['<div class="gui-PlayLogSuggest"><div class="jiao"></div><div id="j-clearing" class="bd ptop" style="background:#F4F4F4; width:270px; height:225px; position:absolute; top:15px; left:0; display:none; z-index:1; border-radius: 4px 4px 4px 4px; "><div style="display:block" class="ui_loading"><img src="http://www.qiyipic.com/common/images/load.gif"><br /><br /><span>\u6b63\u5728\u4e3a\u60a8\u6e05\u7a7a\u64ad\u653e\u8bb0\u5f55</span></div></div><div id="j-clearWindow" class="bd ptop" style="background:#F4F4F4; width:270px; height:225px; position:absolute; top:15px; left:0; display:none; z-index:1; border-radius: 4px 4px 4px 4px; "><div class="wrap-bg0"><div class="wrap-wid"><p>\u662f\u5426\u6e05\u7a7a\u60a8\u5728\u7535\u8111\u3001\u5e73\u677f\u7535\u8111\u3001\u624b\u673a\u3001\u7535\u89c6\u4e0a\u89c2\u770b\u7231\u5947\u827a\u7684\u5168\u90e8\u64ad\u653e\u8bb0\u5f55\uff1f</p><p class="tip"><input id="j-clearBtnOk" type="button" class="btn00 mr15" value="\u786e\u5b9a"><input id="j-clearBtnCancel" type="button" class="btn00" value="\u53d6\u6d88"></p></div></div></div><div class="hd"><a j-delegate="historyClose" class="close" onclick="return false" href="#">\u5173\u95ed</a><div id="j-historyClear" style="text-align:right; float:right; line-height:47px;"><a style="" j-delegate="clearHistory" onclick="return false" href="#">\u6e05\u7a7a\u8bb0\u5f55</a><span style="padding-left:5px; padding-right:8px;">|</span></div></div><div class="bd"><div id="j-historyNothing" class="none_jilu" style="display:none"><p>\u60a8\u6682\u65f6\u6ca1\u6709\u64ad\u653e\u8bb0\u5f55</p><ul>','<li id="j-readme"><span><a target="_blank" class="zhuce" href="http://passport.'+
lib.SITE_DOMAIN+"/register/reg.php?url="+(lib.PROJECT_REG_URL||"")+'">\u6ce8\u518c</a>\u6210</span>\u7231\u5947\u827a\u7528\u6237\uff0c<span><a j-delegate="loginAndClose" class="denglu" href="http://passport.'+lib.SITE_DOMAIN+'/user/login.php">\u767b\u5f55</a>\u540e</span>\u5c06\u80fd\u6c38\u4e45\u4fdd\u5b58\u64ad\u653e\u8bb0\u5f55\u3002</li>','<li>\u64ad\u653e\u8bb0\u5f55\u5728\u7535\u8111\u3001\u5e73\u677f\u7535\u8111\u3001\u624b\u673a\u3001\u7535\u89c6\u4e0a\u89c2\u770b\u7231\u5947\u827a\u5185\u5bb9\u65f6\u4e92\u901a\u3002</li></ul><div id="j-wrongHelp" class="jilu_help">',
'<a href="http://www.'+lib.SITE_DOMAIN+'/common/helpandsuggest.html?entry=yedi#wenti16">\u64ad\u653e\u8bb0\u5f55\u603b\u8bb0\u5f55\u4e0d\u4e0a\u600e\u4e48\u529e\uff1f</a>','</div></div><div style="position:relative;overflow: hidden;"><ul id="j-historyUl"></ul><div id="j-historyMaskLoading" class="ui_loading" style="width:100%;height:100%;position:absolute;top:0;left:0;background-color:#ffffff;opacity:0.8;filter:alpha(opacity=80);display:none;"><img src="http://www.qiyipic.com/common/images/load.gif"><br /><span>\u6b63\u5728\u52aa\u529b\u83b7\u53d6\u5185\u5bb9..</span></div></div><div id="j-historyMiddleLoading" class="ui_loading"><img src="http://www.qiyipic.com/common/images/load.gif"><br /><span>\u6b63\u5728\u52aa\u529b\u83b7\u53d6\u5185\u5bb9..</span></div></div><div class="ft"><div id="j-historyImport" class="loaded" style="display:none"><a j-delegate="historyImportClose" title="\u5173\u95ed" href="#" onclick="return false" class="close">\u5173\u95ed</a><a j-delegate="historyImport" href="#" onclick="return false" class="nologin">\u70b9\u51fb\u5bfc\u5165\u672a\u767b\u5f55\u65f6\u7684\u64ad\u653e\u8bb0\u5f55</a><div style="display:none"><span class="daoru">\u5bfc\u5165\u5b8c\u6210</span>',
'<a href="http://i.'+lib.SITE_DOMAIN+'/bofangjilu" target="_blank">\u67e5\u770b\u5b8c\u6574\u64ad\u653e\u8bb0\u5f55>></a>','</div><div id="j-historyFootLoading" class="ui_loading" style="display:none"><img src="http://www.qiyipic.com/common/images/load.gif"><span>\u6b63\u5728\u52aa\u529b\u83b7\u53d6\u5185\u5bb9..</span></div></div><div id="j-readme2" class="loaded" style="display:none"><div><a j-delegate="readme2Close" class="close" onclick="return false" href="#" title="\u5173\u95ed">\u5173\u95ed</a>',
'<a j-delegate="loginAndClose" href="http://passport.'+lib.SITE_DOMAIN+'/user/login.php" class="corlory">\u767b\u5f55</a>\u540e\u5c06\u80fd\u6c38\u4e45\u4fdd\u5b58\u64ad\u653e\u8bb0\u5f55<span class="fgx_line">|</span>','<a class="corlory" target="_blank" href="http://passport.'+lib.SITE_DOMAIN+"/register/reg.php?url="+(lib.PROJECT_REG_URL||"")+'">\u514d\u8d39\u6ce8\u518c</a>','</div><div><a j-delegate="readme2Close" class="close" onclick="return false" href="#" title="\u5173\u95ed">\u5173\u95ed</a>\u7231\u5947\u827a\u7528\u6237\u5c06\u80fd\u6c38\u4e45\u4fdd\u5b58\u64ad\u653e\u8bb0\u5f55</div></div></div></div><div style="height:50px;width:100%;opacity:0;filter:alpha(opacity=0);background-color:#000000"></div>'].join(""),
listBtn:$("#j-playHistory")},methods:{_setPos:function(){var a=this.listBtn.box(),b=this.listWrapper.box();this.listWrapper.css("top",a.bottom+5+"px").css("left",a.left-b.width+84+"px");this._setIframePos()}}})})();
(function(){lib.Class("IpadPlayHistoryView",{ns:lib.view,extend:lib.view.PlayHistoryView,methods:{init:function(){var a=this;this.superclass.prototype.init.apply(this,arguments);this._player=this._ctrl.isFinalPlayer()&&lib.$("#video")?lib.$("#video"):{on:function(){}};lib.kit.serverTime.init(function(){a._ctrl.loadCrossdomainSrorage.call(a._ctrl,a.initPlayerEvent.bind(a))})},initPlayerEvent:function(){this.superclass.prototype.initPlayerEvent.apply(this);this._ctrl.readCurrent.call(this._ctrl)},_initBindEvent:function(){this.listBtnBinded=
function(a){this.isOpen?this._closeMenu.call(this,a):this._showMenu.call(this,a)}.bind(this);this._setPosBinded=this._setPos.bind(this)},currentReady:function(){this._player.on("timeupdate",this._ctrl.getLastTime.bind(this._ctrl));this._player.on("ended",this._ctrl.playEnd.bind(this._ctrl))},onEvent:function(){this.listBtn.on("click",this.listBtnBinded);$(window).on("resize",this._setPosBinded);this._hasOnEvent=!0},unEvent:function(){this.listBtn.un("click",this.listBtnBinded);$(window).un("resize",
this._setPosBinded);this._hasOnEvent=!1},_showMenu:function(a){this.isOpen=!this.isOpen;lib.Event.stop(a);lib.action.ipadPlayer.hideVideo();this.superclass.prototype._showMenu.apply(this)},_closeMenu:function(){this.isOpen=!this.isOpen;lib.action.ipadPlayer.showVideo();this.superclass.prototype._closeMenu.apply(this)},_itemInitEvent:function(){return"i'm html5"},_getInfo:function(a){a=this.superclass.prototype._getInfo.apply(this,arguments);a.on="on";return a}}})})();lib.reg("lib.model",function(){});
lib.Class("Model",{ns:lib.model,properties:{_data:{}},construct:function(){this._data={}},methods:{init:lib.emptyMethod,get:function(){return this._data},set:function(a){return Object.extend(this._data,a)}}});
(function(){lib.Class("NewPlayHistoryModel",{ns:lib.model,extend:lib.model.Model,construct:function(){this.callsuper()},properties:{_lastTime:0,_timeout:5E3,_serverInterval:120,_ctrl:null,_MSG:{READ:"\u6b63\u5728\u4e3a\u60a8\u8bfb\u53d6\u64ad\u653e\u8bb0\u5f55..",WRITE:"\u6b63\u5728\u4e3a\u60a8\u5199\u5165\u64ad\u653e\u8bb0\u5f55..",DEL:"\u6b63\u5728\u4e3a\u60a8\u5220\u9664\u64ad\u653e\u8bb0\u5f55..",CLEAR:"\u6b63\u5728\u4e3a\u60a8\u6e05\u7a7a\u64ad\u653e\u8bb0\u5f55..",IMPORT:"\u6b63\u5728\u5bfc\u5165\u4e2d.."},
_defaultLogined:!1,_maxSaved:15},methods:{init:function(a){var b=this;this.logined=lib.component.login.isLogin;this._ctrl=a;this._data.list=[];this._initInfo();this._serverInterface=lib.model({crossDomain:!0,actions:{write:{method:"post",params:["tvId","videoId","videoName","videoUrl","videoPlayTime","videoDuration","albumId","albumName","albumUrl","terminalId","channelId","allSet","nextTvid","nextVideoUrl","addtime"],format:"json",encode:!0,url:"setrc.php",timeout:b._timeout},del:{method:"get",params:["tvId"],
format:"json",encode:!0,url:"delrc.php",timeout:b._timeout},read:{method:"get",params:["limit"],format:"json",encode:!0,url:"getrc.php",timeout:b._timeout},sync:{method:"post",params:["importData"],format:"json",encode:!0,url:"import.php",timeout:b._timeout},delAll:{method:"get",params:[],format:"json",encode:!0,url:"delall.php",timeout:b._timeout},readCurrent:{method:"get",params:["tvId"],format:"json",encode:!0,url:"getdetail.php",timeout:b._timeout},readAlbum:{method:"get",params:["albumId"],format:"json",
encode:!0,url:"getalbumrc.php",timeout:b._timeout}},url:"http://passport."+lib.SITE_DOMAIN+"/apis/qiyirc/"});lib._PAGE_EVENT.on("videoPlayStart",function(a){b._ctrl.refreshCurrent.apply(b._ctrl,a.target)});$(window).on("beforeunload",this._closePage.bind(this))},_closePage:function(){try{this._ctrl.isFinalPlayer()&&this._ctrl.getPlayer().windowClose&&this._ctrl.getPlayer().windowClose()}catch(a){}},_initInfo:function(){var a=this._ctrl.INFO||{};this.currentCache={tvId:a.tvId,videoId:a.videoId,videoName:a.title,
videoUrl:a.url||window.location.protocol+"//"+window.location.host+window.location.pathname,albumId:a.albumId,terminalId:"11"}},_notice:function(a,b){var d=JSON.stringify({type:a,data:b||{}}),d=this._ctrl.getClear().notice(d),e;try{d=window.JSON.parse(d),e=d.code=="A00000"?d.data:!1}catch(f){e=!1}return e},_getItem:function(a,b){for(var d=b.length,e=0;e<d;e++)if(b[e].tvId==a)return e;return null},_getLocalJSON:function(a){var b=this._notice("readHistory");a&&(b=window.JSON.stringify(b));return b},
_delLocal:function(a){return this._notice("deleteHistory",{tvId:a})},_localClear:function(){return this._delLocal("-1")},_localAlbum:function(a){var b=this._getLocalJSON(),b=b.filter(function(b){if(a==b.albumId)return!0});return b.length>0?(b.sort(function(a,b){a=parseInt(a.addtime,10);b=parseInt(b.addtime,10);return c=a>b?-1:1}),b[0]):!1},_localTvId:function(a){var b=this._getLocalJSON(),b=b.filter(function(b){if(a==b.tvId)return!0});return b.length>0?b[0]:!1},_serverReadAll:function(){this._serverInterface.read({limit:this._maxSaved},
{success:this.listReady.bind(this),failure:this.listError.bind(this)})},_serverDel:function(a){this._serverInterface.del({tvId:a},{success:this.delReady.bind(this,a),failure:this.delError.bind(this)})},_serverClear:function(){this._serverInterface.delAll({},{success:this.clearReady.bind(this),failure:this.clearError.bind(this)})},_serverSync:function(){this._serverInterface.sync({importData:this._getLocalJSON(!0)},{success:this.importReady.bind(this),failure:this.importError.bind(this)})},_serverAlbum:function(a,
b){this._serverInterface.readAlbum({albumId:a},{success:b,failure:b})},_serverTvId:function(a,b){this._serverInterface.readCurrent({tvId:a},{success:b,failure:b})},deleteSameItems:function(a,b){for(var d={},e=[],f=0,g=a.length;f<g;f++)if(d[a[f]]==void 0||b[f].channelId!="2"&&b[f].channelId!="4")e.push(b[f]),d[a[f]]=1;return e},_swfDataAdapter:function(a){for(var b=[],d=0,e=a.length;d<e;d++)b.push({tvId:a[d].tvId,videoId:a[d].videoId||a[d].vid,videoName:a[d].videoName||a[d].title,videoUrl:a[d].videoUrl||
a[d].url,videoPlayTime:isNaN(parseInt(a[d].videoPlayTime))?a[d].time:a[d].videoPlayTime,videoDuration:a[d].videoDuration,albumId:a[d].albumId,albumName:a[d].albumName,albumUrl:a[d].albumUrl,terminalId:a[d].terminalId,channelId:a[d].channelId,allSet:a[d].allSet,nextTvid:a[d].nextTvid,nextVideoUrl:a[d].nextVideoUrl||a[d].nextUrl});return b},_dataFilter:function(a){for(var b=[],d=0,e=a.length;d<e;d++)b.push(a[d].albumId);return this.deleteSameItems(b,a)},listReady:function(a){a=typeof a=="string"?eval(a):
this._dataFilter(a);a=this._swfDataAdapter(a);this.listReadyEvent(a);this._lastTime=parseInt(new Date/1E3);this._ctrl.syncSet({list:a,type:"listReady",update:!0})},listReadyEvent:function(a){lib._PAGE_EVENT.fire({type:"playHistoryLoaded",target:a});return a},listError:function(a){this.listErrorEvent(a);this._ctrl.syncSet({list:a,type:"listError",update:!0})},listErrorEvent:function(){lib._PAGE_EVENT.fire({type:"playHistoryLoaded",target:[]})},delReady:function(a){lib._PAGE_EVENT.fire({type:"playHistoryDel",
target:a});this._ctrl.syncSet({type:"delReady",update:!0})},delError:function(){lib._PAGE_EVENT.fire({type:"playHistoryDel",target:!1});this._ctrl.syncSet({type:"delError",update:!0})},importReady:function(){lib._PAGE_EVENT.fire({type:"playHistoryImport",target:!0});this._ctrl.syncSet({type:"importReady",update:!0})},importError:function(){lib._PAGE_EVENT.fire({type:"playHistoryImport",target:!1});this._ctrl.syncSet({type:"importError",update:!0})},clearReady:function(){lib._PAGE_EVENT.fire({type:"playHistoryClear",
target:!0});this._ctrl.syncSet({type:"clearReady",update:!0})},clearError:function(){lib._PAGE_EVENT.fire({type:"playHistoryClear",target:!1});this._ctrl.syncSet({type:"clearError",update:!0})},refreshCurrent:function(a,b,d){this.currentCache.videoId=a;this.currentCache.videoName=b;this.currentCache.tvId=d},rerfeshHistory:function(){this._ctrl.syncSet({type:"listReady",update:!0})},readHistory:function(a){this._ctrl.setLoading(this._MSG.READ,"Mask",!0);a&&this.clearLastLoadTime();if(this.logined())if(parseInt(new Date/
1E3)-this._lastTime>this._serverInterval){this._lastTime=parseInt(new Date/1E3);try{this._serverReadAll()}catch(b){}}else this._ctrl.setLoading("","Mask",!1);else this.listReady(this._getLocalJSON())},deleteHistory:function(a){this._ctrl.setLoading(this._MSG.DEL,"Mask",!0);this.logined()?this._serverDel(a):(this._delLocal(a),this.delReady())},clearHistory:function(){this._ctrl.setLoading(this._MSG.CLEAR,"All",!0);this.logined()?this._serverClear():(this._localClear(),this.clearReady())},importHistory:function(){this.logined()&&
(this._ctrl.setLoading(this._MSG.IMPORT,"Foot",!0),this._serverSync())},isOpenFlashCookie:function(){return!!this._notice("isOpenedCookie")},albumHistory:function(a,b){this.logined()?this._serverAlbum(a,b):b(this._localAlbum(a))},tvIdHistory:function(a,b){this.logined()?this._serverTvId(a,b):b(this._localTvId(a))},clearLastLoadTime:function(){this._lastTime=0}}})})();
$reg("lib.action.CrossdomainStorage",function(){lib.action.CrossdomainStorage=Class.create({initialize:function(a){this.fn=a||lib.emptyMethod;this._url="http://www."+lib.SITE_DOMAIN+"/common/newacross.html";this._localStrorage=null;this._instance=lib.action.CrossdomainStorage;this._createFrame()},_createFrame:function(){var a=this,b;this._url.indexOf(location.host)==-1?this._instance._iframe?(this._localStrorage=this._instance._iframe[0].contentWindow.localStorage,setTimeout(this.fn,0)):(b=lib.Element.create("iframe"),
this._instance._iframe=b,b.css("height","0px").css("width","0px").attr("frameBorder","0").attr("src",this._url).on("load",function(){a._localStrorage=b[0].contentWindow.localStorage;a.fn()}),$(document.body).append(b)):(this._localStrorage=window.localStorage,setTimeout(this.fn,0))},removeItem:function(a){this._localStrorage.removeItem(a)},setItem:function(a,b){this._localStrorage.removeItem(a);this._localStrorage[a]=b},getItem:function(a){return this._localStrorage[a]},length:function(){return this._localStrorage.length},
getAll:function(){return Object.Extend({},this._localStrorage)},getStorage:function(){return this._localStrorage},state:function(){return!!this._localStrorage}})});
(function(){lib.Class("NewIpadPlayHistoryModel",{ns:lib.model,extend:lib.model.NewPlayHistoryModel,construct:function(){this.callsuper()},properties:{_newTime:0,_lastTime:0,_continued:!1,localInterval:30,_storage:null,_localKey:"localHistory",_saveStamp:-1},methods:{_closePage:function(){try{if(this._ctrl.isFinalPlayer()&&lib.$("#video"))this._saveStamp=this._serverInterval/this.localInterval,this.writeHistory.apply(this)}catch(a){}},_getStorage:function(a){this._storage=new lib.action.CrossdomainStorage(a)},
_initInfo:function(){this.superclass.prototype._initInfo.apply(this);var a=this._ctrl.INFO;try{this.currentCache.videoDuration=this._getSecond(a.data.playLength),this.currentCache.terminalId="21",this.currentCache.nextVideoUrl=a.ipad.nextVideoUrl,this.currentCache.channelId=a.ipad.categoryId}catch(b){}},_getSecond:function(a){a=a.split(":");return parseInt(a[0],10)*3600+parseInt(a[1],10)*60+parseInt(a[2],10)*1},_addItem:function(a,b){b.splice(this._maxSaved-1);b.unshift(a)},_delItem:function(a,b){a.splice(b,
1)},_updateItem:function(a,b,d){b[d]=a},_getLocalJSON:function(a){var b=this._storage.getItem(this._localKey)||"[]";a||(b=window.JSON.parse(b));return b},_syncLocal:function(a){this._storage.setItem(this._localKey,window.JSON.stringify(a))},_writeLocal:function(){var a=this._getLocalJSON(),b=this._getItem(this.currentCache.tvId,a);b===null?this._addItem(Object.extend({addtime:lib.kit.serverTime.now()},this.currentCache),a):this._updateItem(Object.extend({addtime:lib.kit.serverTime.now()},this.currentCache),
a,b);this._syncLocal(a)},_delLocal:function(a){var b=this._getLocalJSON(),a=this._getItem(a,b);a!==null&&(this._delItem(b,a),this._syncLocal(b))},_localClear:function(){this._syncLocal(this._localKey,[])},_readCurrent:function(a){var b;this.logined()?this._serverReadCurrent(a):(b=this._getLocalJSON(),index=this._getItem(this.currentCache.tvId,b),index!==null?a(b[index]):a({}))},_serverWrite:function(){this._serverInterface.write(this.currentCache,{success:this.writeReady.bind(this),failure:this.writeError.bind(this)})},
_serverReadCurrent:function(a){this._serverInterface.readCurrent({tvId:this.currentCache.tvId},{success:a,failure:a})},moveItem2First:function(){var a;a=this.logined()?this._data.list:this._getLocalJSON();index=this._getItem(this.currentCache.tvId,a);index!==null&&(this._delItem(a,index),this._addItem(Object.extend({addtime:lib.kit.serverTime.now()},this.currentCache),a));this.logined()||this._syncLocal(a)},getHistory2Cache:function(){var a=this;this._readCurrent(function(b){a.currentCache.videoPlayTime=
b.videoPlayTime||-1;a.currentReady()})},writeHistoryCache:function(a){this.currentCache.videoPlayTime=a;this.writeHistory()},writeHistory:function(){if(this.logined()){if(this._saveStamp++,this._saveStamp==this._serverInterval/this.localInterval||this.currentCache.videoPlayTime==0||this.currentCache.videoPlayTime==-1||this._saveStamp==-1)this._serverWrite(),this._saveStamp=0}else this._writeLocal()},writeReady:function(){this._ctrl.syncSet({type:"writeReady",update:!0})},writeError:function(){this._ctrl.syncSet({type:"writeError",
update:!0})},currentReady:function(){this._ctrl.syncSet({type:"currentReady",update:!0})},isOpenFlashCookie:function(){return!0}}})})();
(function(){lib.Class("Adapter",{ns:lib.action,construct:function(a,b){if(a instanceof lib.model.Model)this._model=a,this._model.init(this);if(b instanceof lib.view.View)this._view=b,this._view.init(this)},methods:{syncGet:function(a){if(this._model)var b=this._model.get(a);this._view&&this._view.update(b)},asyncGet:function(a){if(!this._model)return!1;var b=this;this._model.get(a,function(a){b._view&&b._view.update(a)})},syncSet:function(a){if(this._model)var b=this._model.set(a);this._view&&this._view.update(b)},
asyncSet:function(a){if(!this._model)return!1;var b=this;this._model.set(a,function(a){b._view&&b._view.update(a)})}}})})();
(function(){lib.Class("NewPlayHistory",{ns:lib.action,extend:lib.action.Adapter,construct:function(a,b){this.callsuper(a,b);lib.action.NewPlayHistory.instance=this;this.playNextVideoStatic=this.playNextVideo.bind(this);this.history2stringStatic=this.history2string.bind(this);this.getClearStatic=this.getClear.bind(this)},properties:{PLAYER_ID:"flash",INFO:window.info||{},haveNextVideo:!1,cookieName:"hasImportHistory",loginedFlag:"loginedTip",unloginFlag:"unloginTip"},methods:{playNextVideo:function(a,
b,d){this.haveNextVideo=!0;this.refreshCurrent(a,b,d)},history2string:function(){for(var a=this._model._data.list,b=a.length,d=[],e=0;e<b;e++)d.push([a[e].videoName,a[e].videoPlayUrl,a[e].videoPlayTime,a[e].videoId].join("*"));return d.join("|")},initized:function(){this._model.initizedSwf.apply(this._model)},refreshHistory:function(){this._model.rerfeshHistory.apply(this._model)},refreshCurrent:function(){this._model.refreshCurrent.apply(this._model,arguments);this._view.refreshCurrent.apply(this._view,
arguments)},readHistory:function(a){this._model.readHistory(a)},deleteHistory:function(a){this._model.deleteHistory(a)},importHistory:function(){this._model.importHistory()},clearHistory:function(){this._model.clearHistory()},setLoading:function(a,b,d){this.syncSet({loading:{position:b,ing:d,loadMsg:a,update:!0},type:"setLoading"})},getClear:function(){return this._view.getClear()},getPlayer:function(){return this._view.getPlayer()},getCurrentInfo:function(){return Object.extend({},this._model.currentCache)},
isFinalPlayer:function(){return!!$("#flashArea")},getAlbum:function(a,b){this._model.albumHistory(a,b)},getByTvId:function(a,b){this._model.tvIdHistory(a,b)},isOpenFlashCookie:function(){return this._model.isOpenFlashCookie.call(this._model)},getLocalHistory:function(){return this._model._getLocalJSON.call(this._model)},openImport:function(){this.syncSet({type:"openImport",update:!0})},closeImport:function(){this.syncSet({type:"closeImport",update:!0})},clearLastLoadTime:function(){this._model.clearLastLoadTime()},
notice2swf:function(a){a&&this._model._notice("userLogined",{uid:a});this.getPlayer()&&this.getPlayer().userLogined&&this.getPlayer().userLogined(lib.component.login.isLogin(),a||"-1");this.getPlayer()&&this.getPlayer().setQiyiUserLogin&&(a=JSON.stringify({login:lib.component.login.isLogin().toString(),PassportId:a||"",name:lib.component.login.getUserInfo().nickname||""}),this.getPlayer().setQiyiUserLogin(a))}}})})();
(function(){lib.Class("NewIpadPlayHistory",{ns:lib.action,extend:lib.action.NewPlayHistory,construct:function(a,b){this.callsuper(a,b)},methods:{recordInterval:function(a){var a=Math.round(a.target.currentTime),b=this._model,d=a%b.localInterval;b._newTime=a;if(a!=0&&b._newTime!=b._lastTime&&d==0)b._lastTime=a,b.currentCache.videoDuration-a<=30?b.writeHistoryCache(0):b.writeHistoryCache(a)},getLastTime:function(a){var b=this._model;if(!this.lastTimeLoaded)this.lastTimeLoaded=!0,$(a.target).on("timeupdate",
this.recordInterval.bind(this)),b.continued||this.continuePlay(a)},continuePlay:function(a){var b=this._model,d=a.target,e,f=function(){try{clearTimeout(e),d.currentTime=b.currentCache.videoPlayTime}catch(a){e=setTimeout(f,0)}};b.currentCache.videoPlayTime&&b.currentCache.videoPlayTime>0?(f(),b.continued=!0,b.moveItem2First()):this._playStart()},readCurrent:function(){this._model.getHistory2Cache()},_playStart:function(){this._model.writeHistoryCache(-1)},playEnd:function(){this._model.writeHistoryCache(0)},
loadCrossdomainSrorage:function(a){this._model._getStorage.call(this._model,a)},notice2swf:function(){return"i'm html5"}}})})();
(function(){var a,b,d,e;try{e=!!top.lib.action.NewPlayHistory.instance}catch(f){e=!1}$("#j-playHistory")&&!e&&(lib.ipad||lib.noFlashAndroid?(e=new lib.kit.Monitor(function(){if($("#flashArea"))try{if(a=lib.$("#video")[0],!a)return!1}catch(e){return!1}b=new lib.model.NewIpadPlayHistoryModel;d=new lib.view.IpadPlayHistoryView;new lib.action.NewIpadPlayHistory(b,d);return!0},{time:200}),e.start()):(b=new lib.model.NewPlayHistoryModel,d=new lib.view.PlayHistoryView,new lib.action.NewPlayHistory(b,d)))})();
lib.Class("ClearSwf",{ns:lib.action,statics:{CLEAR_URL:((new lib.kit.Url(window.location.href)).getParam("clear")||"http://www.iqiyi.com/player/20121108152912/clear.swf")+"?ran="+Math.random(),CLEAR_ID:"clearSwf",get:function(){var a=lib.action.ClearSwf.CLEAR_ID;return window[a]||document[a]||document.getElementById(a)},getId:function(){return lib.action.ClearSwf.CLEAR_ID},load:function(){if(!$("#qiyiClearSwf")){var a=document.createElement("div");Object.extend(a.style,{left:"-10000px",position:"absolute"});
document.body.insertBefore(a,null);a.setAttribute("id","qiyiClearSwf");a.innerHTML=lib.kit.video.render("width",1,"height",1,"src",lib.action.ClearSwf.CLEAR_URL,"id",lib.action.ClearSwf.CLEAR_ID,"movie",lib.action.ClearSwf.CLEAR_URL,"align","middle","isstr",!0,"FlashVars","UUIDDuration=8000")}}}});
lib.Class("AccSwf",{ns:lib.action,statics:{ACC_URL:((new lib.kit.Url(window.location.href)).getParam("acc")||"http://www.iqiyi.com/player/20120412155548/acc.swf")+"?ran="+Math.random(),ACC_ID:"accSwf",get:function(){var a=lib.action.AccSwf.ACC_ID;return window[a]||document[a]||document.getElementById(a)},getId:function(){return lib.action.AccSwf.ACC_ID},load:function(){if(!$("#qiyiAccSwf")){var a=document.createElement("div");Object.extend(a.style,{left:"-10000px",position:"absolute"});document.body.insertBefore(a,
null);a.setAttribute("id","qiyiAccSwf");a.innerHTML=lib.kit.video.render("width",1,"height",1,"src",lib.action.AccSwf.ACC_URL,"id",lib.action.AccSwf.ACC_ID,"movie",lib.action.AccSwf.ACC_URL,"align","middle","isstr",!0)}}}});(function(){lib.swf.postServerUID=function(a){lib.qa_postServerUID=a};lib.ipad||(lib.action.ClearSwf.load(),lib.action.AccSwf.load())})();(function(){lib.Class("FloaterModel",{ns:lib.model,extend:lib.model.Model,methods:{init:function(){this._data={display:!1}}}})})();
(function(){$reg("lib.ui",function(){});lib.ui.viewCenter=function(a,b){b=b||"absolute";if(a){var d=a.offsetWidth,e=a.offsetHeight,f=lib.box.getViewportWidth(),g=lib.box.getViewportHeight();if(!d||!e)throw"zero width or height.";d={left:(f-d)/2+lib.box.getPageScrollLeft(),top:(g-e)/2+lib.box.getPageScrollTop()};a.style.position=b;$(a).pos(d)}}})();
(function(){lib.Class("FloaterView",{ns:lib.view,extend:lib.view.View,construct:function(a){this.callsuper(a);this.doOnresize(a)},methods:{init:function(a){this._ctrl=a;this._elem=lib.Element.create("div");this._elem.css("position","absolute");this._elem.css("zIndex","1000");this._elem.css("overflow","hidden");this._elem.css("visibility","hidden");lib.$(document.body).append(this._elem)},update:function(a){a.display?(this.build(a),this.show(),this.showCover(),this.adjustPosition(),this.playAnim()):
(this.hide(),this.hideCover())},getFloater:function(){return this._elem},build:function(a){if(a.id){if(a=lib.$("#"+a.id))this._elem.append(a),a.show()}else a.html&&this._elem.html(a.html)},pos:function(a){this._elem.pos(a)},show:function(){this._elem.css("visibility","visible");this.hidePlayer()},hide:function(){this._elem.css("visibility","hidden");this.showPlayer()},showPlayer:function(){lib.ipad||lib._PLAYER_WMODE_SP&&lib._PLAYER_WMODE_SP.hide()},hidePlayer:function(){lib.ipad||lib._PLAYER_WMODE_SP&&
lib._PLAYER_WMODE_SP.show()},destroy:function(){this._removeEvent();this._removeDom()},adjustPosition:function(){var a=this;setTimeout(function(){lib.ui.viewCenter(a._elem[0]);a._elem.box().top<0&&a._elem.css("top","30px")},0)},showCover:function(){this._cover=lib.kit.Overlay.create({color:"#000",zIndex:112})},hideCover:function(){lib.kit.Overlay.destroy(this._cover)},playAnim:function(){},_removeDom:function(){this._elem.remove()},_removeEvent:function(){if(this.winObj)this.winObj.un("resize",this.adjustPosition),
this.winObj=null},isOpen:function(){return this._elem.css("visibility")=="visible"},doOnresize:function(a){if(a&&a.isResize)this.winObj=lib.$(window),this.winObj.on("resize",this.adjustPosition.bind(this))}}})})();
(function(){lib.Class("Floater",{ns:lib.action,extend:lib.action.Adapter,construct:function(a,b){a=a||new lib.model.FloaterModel;b=b||new lib.view.FloaterView;this.callsuper(a,b);this._valid=!0},methods:{show:function(a){a=a||{};Object.extend(a,{display:!0});this._model.set(a);this.syncGet()},hide:function(){this._model.set({display:!1});this.syncGet()},pos:function(a){this._view.pos(a)},getFloater:function(){return this._view.getFloater()},destroy:function(){this.hide();if(this._valid)this._model.destroy&&
this._model.destroy(),this._view.destroy&&this._view.destroy(),this._valid=!1},isValid:function(){return this._valid},isOpen:function(){return this._view.isOpen()}}})})();
$reg("lib.ui.Anim",function(){var a={Linear:function(a,d,e,f){return e*a/f+d},Quad:{easeIn:function(a,d,e,f){return e*(a/=f)*a+d},easeOut:function(a,d,e,f){return-e*(a/=f)*(a-2)+d},easeInOut:function(a,d,e,f){if((a/=f/2)<1)return e/2*a*a+d;return-e/2*(--a*(a-2)-1)+d}},Cubic:{easeIn:function(a,d,e,f){return e*(a/=f)*a*a+d},easeOut:function(a,d,e,f){return e*((a=a/f-1)*a*a+1)+d},easeInOut:function(a,d,e,f){if((a/=f/2)<1)return e/2*a*a*a+d;return e/2*((a-=2)*a*a+2)+d}},Quart:{easeIn:function(a,d,e,f){return e*
(a/=f)*a*a*a+d},easeOut:function(a,d,e,f){return-e*((a=a/f-1)*a*a*a-1)+d},easeInOut:function(a,d,e,f){if((a/=f/2)<1)return e/2*a*a*a*a+d;return-e/2*((a-=2)*a*a*a-2)+d}},Quint:{easeIn:function(a,d,e,f){return e*(a/=f)*a*a*a*a+d},easeOut:function(a,d,e,f){return e*((a=a/f-1)*a*a*a*a+1)+d},easeInOut:function(a,d,e,f){if((a/=f/2)<1)return e/2*a*a*a*a*a+d;return e/2*((a-=2)*a*a*a*a+2)+d}},Sine:{easeIn:function(a,d,e,f){return-e*Math.cos(a/f*(Math.PI/2))+e+d},easeOut:function(a,d,e,f){return e*Math.sin(a/
f*(Math.PI/2))+d},easeInOut:function(a,d,e,f){return-e/2*(Math.cos(Math.PI*a/f)-1)+d}},Expo:{easeIn:function(a,d,e,f){return a==0?d:e*Math.pow(2,10*(a/f-1))+d},easeOut:function(a,d,e,f){return a==f?d+e:e*(-Math.pow(2,-10*a/f)+1)+d},easeInOut:function(a,d,e,f){if(a==0)return d;if(a==f)return d+e;if((a/=f/2)<1)return e/2*Math.pow(2,10*(a-1))+d;return e/2*(-Math.pow(2,-10*--a)+2)+d}},Circ:{easeIn:function(a,d,e,f){return-e*(Math.sqrt(1-(a/=f)*a)-1)+d},easeOut:function(a,d,e,f){return e*Math.sqrt(1-(a=
a/f-1)*a)+d},easeInOut:function(a,d,e,f){if((a/=f/2)<1)return-e/2*(Math.sqrt(1-a*a)-1)+d;return e/2*(Math.sqrt(1-(a-=2)*a)+1)+d}},Elastic:{easeIn:function(a,d,e,f,g,h){if(a==0)return d;if((a/=f)==1)return d+e;h||(h=f*0.3);!g||g<Math.abs(e)?(g=e,e=h/4):e=h/(2*Math.PI)*Math.asin(e/g);return-(g*Math.pow(2,10*(a-=1))*Math.sin((a*f-e)*2*Math.PI/h))+d},easeOut:function(a,d,e,f,g,h){if(a==0)return d;if((a/=f)==1)return d+e;h||(h=f*0.3);if(!g||g<Math.abs(e))var g=e,i=h/4;else i=h/(2*Math.PI)*Math.asin(e/
g);return g*Math.pow(2,-10*a)*Math.sin((a*f-i)*2*Math.PI/h)+e+d},easeInOut:function(a,d,e,f,g,h){if(a==0)return d;if((a/=f/2)==2)return d+e;h||(h=f*0.3*1.5);if(!g||g<Math.abs(e))var g=e,i=h/4;else i=h/(2*Math.PI)*Math.asin(e/g);if(a<1)return-0.5*g*Math.pow(2,10*(a-=1))*Math.sin((a*f-i)*2*Math.PI/h)+d;return g*Math.pow(2,-10*(a-=1))*Math.sin((a*f-i)*2*Math.PI/h)*0.5+e+d}},Back:{easeIn:function(a,d,e,f,g){g==void 0&&(g=1.70158);return e*(a/=f)*a*((g+1)*a-g)+d},easeOut:function(a,d,e,f,g){g==void 0&&
(g=1.70158);return e*((a=a/f-1)*a*((g+1)*a+g)+1)+d},easeInOut:function(a,d,e,f,g){g==void 0&&(g=1.70158);if((a/=f/2)<1)return e/2*a*a*(((g*=1.525)+1)*a-g)+d;return e/2*((a-=2)*a*(((g*=1.525)+1)*a+g)+2)+d}},Bounce:{easeIn:function(b,d,e,f){return e-a.Bounce.easeOut(f-b,0,e,f)+d},easeOut:function(a,d,e,f){return(a/=f)<1/2.75?e*7.5625*a*a+d:a<2/2.75?e*(7.5625*(a-=1.5/2.75)*a+0.75)+d:a<2.5/2.75?e*(7.5625*(a-=2.25/2.75)*a+0.9375)+d:e*(7.5625*(a-=2.625/2.75)*a+0.984375)+d},easeInOut:function(b,d,e,f){return b<
f/2?a.Bounce.easeIn(b*2,0,e,f)*0.5+d:a.Bounce.easeOut(b*2-f,0,e,f)*0.5+e*0.5+d}}};lib.ui._anim=Class.create({initialize:function(a){this.opt=Object.extend({duration:1E3,onStart:function(){},onDone:function(){},onCompute:function(){},interval:10,ease:"",el:null},a||{});this.ease();this.counter=0;this.el=this.opt.el?$(this.opt.el):null;this.info={}},getAnim:function(a,d,e){for(var f=[],g=0;g<a;g++)f.push(this.tweenFunc(g,d,e,a));return f},getAnimInfo:function(){this.interval=this.opt.duration/this.opt.interval;
for(var a in this.info){if(this.info[a].from==void 0)this.info[a].from=this.getDefaultFrom(this.el,a);this.info[a].unit=a=="opacity"?"":"px";this.info[a].animArray=this.getAnim(this.interval,this.info[a].from,this.info[a].to-this.info[a].from)}},getDefaultFrom:function(a,d){if(d=="scroll")return lib.box.getPageScrollTop();return parseInt(a.css(d))||0},onCompute:function(){for(var a in this.info)a=="scroll"?window.scrollTo(0,this.info[a].animArray[this.counter]):this.el.css(a,this.info[a].animArray[this.counter]+
this.info[a].unit);this.counter++},compute:function(){this.counter>=this.interval?(clearTimeout(this.iTimer),this.done(),this.counter=0):(this.onCompute(),this.iTimer=setTimeout(function(){this.compute()}.bind(this),this.opt.interval))},ease:function(b){if(!b)return this.tweenFunc=a.Linear,this;b=b.split(".");this.tweenFunc=b.length!=2?a.Linear:a[b[0]][b[1]];return this},duration:function(a){this.opt.duration=a;return this},delay:function(a){this.opt.interval=a;return this},done:function(){for(var a in this.info)a==
"scroll"?window.scrollTo(0,this.info[a].to):this.el.css(a,this.info[a].to+this.info[a].unit);if(this.opt.onDone)this.opt.onDone();this.info={}},from:function(a,d){this.info[a]||(this.info[a]={});this.info[a].from=d;return this},to:function(a,d){this.info[a]||(this.info[a]={});this.info[a].to=d;return this},scrollTo:function(a){this.info.scroll||(this.info.scroll={});this.info.scroll.to=a;return this},go:function(){this.getAnimInfo();this.inAnim=!0;this.iTimer&&clearTimeout(this.iTimer);this.compute();
return this},stop:function(){this.pause();this.counter=0},pause:function(){this.inAnim&&clearTimeout(this.iTimer);this.getAnimInfo()},resume:function(){this.compute()},onDone:function(a){this.opt.onDone=a;return this}});lib.ui.Anim=function(a){return new lib.ui._anim({el:a})}});
(function(){lib.Class("RightBottomFloaterView",{ns:lib.view,extend:lib.view.FloaterView,methods:{init:function(){this.superclass.prototype.init.apply(this,arguments);this._loadedForFirstTime=!1;this._initEvent()},build:function(){this.superclass.prototype.build.apply(this,arguments);this._viewWidth=lib.box.getDocumentWidth()},adjustPosition:function(){var a=lib.box.getViewportHeight();this._elem.box();this._srcPos={right:0,top:a+lib.box.getPageScrollTop()};this._elem.pos(this._srcPos);this.showAnim()},
showAnim:function(){if(this._srcPos){var a=this._elem;a.box();this._destPos={top:this._srcPos.top-a.box().height,right:this._srcPos.right};a=lib.ui.Anim(a);a.duration(500);a.ease("Expo.easeOut");!this._loadedForFirstTime&&(a.from("top",this._srcPos.top).to("top",this._destPos.top).go(),1)||this._elem.pos(this._destPos);this._loadedForFirstTime=!0}},hideAnim:function(){if(this._srcPos&&this._destPos){var a=lib.ui.Anim(this._elem);a.duration(500);a.ease("Expo.easeOut");a.from("top",this._destPos.top).to("top",
this._srcPos.top).go().onDone(function(){})}},showCover:function(){},hideCover:function(){},_initEvent:function(){var a=this.adjustPosition.bind(this);$(window).on("resize",a);$(window).on("scroll",a)}}})})();
(function(){lib.Class("DueVipFloater",{ns:lib.action,extend:lib.action.Floater,construct:function(a){this.callsuper(a,new lib.view.RightBottomFloaterView)},methods:{initInfo:function(){var a=[];a.push('<div style="width:275px; height:95px; border:4px solid #dbdbdb; background-color:#fff; padding:15px; color:#6c6c6c;">');a.push('  <div style="height:16px; margin-bottom:15px;">');a.push("      <div style=\"float:left; color:#58a800; font:bold 14px/16px '\u5b8b\u4f53'\">\u4f1a\u5458\u5230\u671f\u63d0\u9192</div>");
a.push('      <a id="dueVip_closeBut" href="#" style="float:right; display:block;"><img style="border:none;" src="http://www.qiyipic.com/vip/fix/popClose.gif" /></a>');a.push("  </div>");this.vipInfo.isExpire?a.push('  <div style="font-size:12px; clear:both;">\u60a8\u7684\u5947\u827a\u4f1a\u5458<font style="color:#f26700; font-weight:bold;">\u5df2\u8fc7\u671f</font>\uff0c\u65e0\u6cd5\u7ee7\u7eed\u4f7f\u7528\u4f1a\u5458\u7279\u6743\u3002</div>'):a.push('  <div style="font-size:12px; clear:both;">\u60a8\u7684\u5947\u827a\u4f1a\u5458\u5c06\u4e8e<font style="color:#f26700; font-weight:bold;">'+
this.vipInfo.vipInfo.deadline.replace("\u5e74","/").replace("\u6708","/").replace("\u65e5","")+"</font>\u8fc7\u671f\uff0c\u8bf7\u53ca\u65f6\u7eed\u8d39\u3002</div>");a.push('  <div style="padding-top:20px;font-size:12px;height:26px;">');a.push('    <span style="float:left; line-height:21px; margin-top:5px;"><input id="j-continueNotice" style="vertical-align:middle;margin-top:-2px;*margin-top:-1px;_margin-top:-3px;margin-right:3px; margin-left:0; width:12px;" type="checkbox" />\u4e0d\u518d\u63d0\u9192</span>');
a.push('    <a id="j-noticeVip" href="http://serv.vip.iqiyi.com/order/guide.action?pid=a0226bd958843452&cid=afbe8fd3d73448c9&platform=b6c13e26323c537d&fr=IQY-VIP-0101&fc=b780b6da8588dd48" style="background:url(http://www.qiyipic.com/common/fix/dingyue_images/dingyueIcon.png) no-repeat 0 -46px; width:75px; height:26px; line-height:26px; display:inline-block; text-align:center; color:#fff; font-size:12px; text-decoration:none;float:right;">\u7acb\u5373\u7eed\u8d39</a>');a.push("  </div>");a.push("</div>");
this.show({html:a.join("")});lib.kit.slog.log({type:"huiyuanxufeitip",uid:lib.cookie.get("QC005"),ppuid:lib.cookie.get("P00003")},"http://msg.video.qiyi.com/tmpstats.gif");this.bindEvent()},bindEvent:function(){this.closeBut=lib.$("#dueVip_closeBut");this.closeBut.on("click",this.closeButClick.bind(this));this.continueNoticeCheckbox=lib.$("#j-continueNotice");this.continueNoticeCheckbox.on("click",this.checkContinueNotice.bind(this))},closeButClick:function(a){this.destroy();lib.Event.stop(a)},checkContinueNotice:function(){var a=
this.continueNoticeCheckbox[0].checked,b=lib.component.login.getUserInfo();a?lib.cookie.set("vip-contNoti"+b.uid,"false",8640,"/",lib.SITE_DOMAIN):lib.cookie.set("vip-contNoti"+b.uid,"true",8640,"/",lib.SITE_DOMAIN)},setVipInfo:function(a){this.vipInfo=a}}})})();
(function(){function a(){(new lib.kit.Monitor(function(){if(lib.component.login.vipInfo===void 0)return!1;if(lib.component.login.vipInfo&&lib.component.login.vipInfo.remind==1&&lib.component.login.vipInfo.type=="prepay"){var a=lib.component.login.getUserInfo();lib.cookie.get("vip-contNoti"+a.uid)!="false"&&(a=new lib.action.DueVipFloater,a.setVipInfo(lib.component.login),a.initInfo())}})).start()}lib.component.login.isLogin()&&a();lib.component.login.setCallback("login",function(){a()})})();
(function(a){function b(a){lib.eventTarget.call(this);this._initEvent();this.box=a}function d(a){b.call(this,a.parent());this.ele=a}function e(a,d){b.call(this,a);this.ele=a;this.path=d;this.tempImg=null}function f(){this._allImgs=[];this._check=this.check.bind(this)}function g(a,d){b.call(this,a);this.ele=a;this.fn=d}lib.action.lazyLoad=b;b.inherits(lib.eventTarget);Object.extend(b.prototype,{_initEvent:function(){this._check=this.check.bind(this);$(a).on("scroll",this._check);$(a).on("resize",this._check);
document.addEventListener&&document.addEventListener("DOMContentLoaded",this._check,!1);$(a).on("load",this._check)},release:function(){this._check&&($(a).un("scroll",this._check),$(a).un("resize",this._check),document.removeEventListener&&document.removeEventListener("DOMContentLoaded",this._check,!1),$(a).un("load",this._check))},check:function(){var a=lib.box.getViewportHeight()+lib.box.getPageScrollTop();this.box.pos().top<=a?(this.fire({type:"within"}),this.within()):(this.fire({type:"without"}),
this.without())},within:function(){},without:function(){}});lib.action.lazyRender=d;d.inherits(b);Object.extend(d.prototype,{within:function(){var a=this.ele.val();a&&this.box.html(a);this.release()}});e.inherits(b);Object.extend(e.prototype,{within:function(){this.tempImg=new Image;this.tempImg.onload=this._imgOnload.bind(this);this.tempImg.src=this.path;this.release()},_imgOnload:function(){this.tempImg=this.tempImg.onload=null}});Object.extend(f.prototype,{init:function(b){if(b!=null){for(var b=
b.elements(),d=0,e=b.length;d<e;d++){var f=b[d];if(!f.getAttribute("src")){f._pos=$(f).pos();var g=f.getAttribute("data-lazy"),l=lib.$(f).box(),n=l.right;(l.left>0||n>0)&&g.indexOf("cache")===-1&&this._allImgs.push(f)}}this.check();if(this._allImgs.length>0){if(!this._scroll)$(a).on("scroll",this._check),$(a).on("resize",this._check),this._scroll=!0}else $(a).un("scroll",this._check),$(a).un("resize",this._check),this._scroll=!1}},showImg:function(b){var d=b.getAttribute("data-lazy");if(d&&(b.src=
d,a.location.href.indexOf("debug=lazyload")!==-1))b.style.border="1px solid #f00";this._allImgs.del(b)},check:function(){if(this._allImgs.length==0)$(a).un("scroll",this._check),$(a).un("resize",this._check),this._scroll=!1;var b=this._allImgs,d=lib.box.getPageScrollTop(),e=lib.box.getViewportHeight(),e=d+e;for(len=b.length;len>0;len--){var f=b[len-1],g=lib.$(f).box(),l=g.top,n=g.bottom,p=g.right;(g.left>0||p>0)&&(l>=d&&l<=e||n>=d&&n<=e)&&this.showImg(f)}}});g.inherits(b);Object.extend(g.prototype,
{within:function(){this.fn();this.release()}});lib.action.lazy=lib.action.lazy||{init:function(a,b){switch(a){case "render":this._render();break;case "cache":this._cache();break;case "cb":this._callback(b);break;default:this._loadImg()}},_render:function(){var a=$("textarea[data-lazy='render']");if(a)for(var b=0;b<a.length;b++)new d($(a[b]))},_cache:function(){var a=$("img[data-lazy]"),b="";if(a)for(var d=0;d<a.length;d++)b=a[d].getAttribute("data-lazy"),b.indexOf("cache")===0&&b.slice(6).trim()!==
""&&new e($(a[d]),b.slice(6).trim())},_loadImg:function(){var a=lib.$("img[data-lazy]");this._LazyImg=new f;a&&this._LazyImg.init(a)},add:function(){var a=lib.$("img[data-lazy]");this._LazyImg&&a&&this._LazyImg.init(a)},_callback:function(a){a.cb&&a.ele&&new g(a.ele,a.cb)}}})(this);(function(){lib.action.lazy.init();lib.action.lazy.init("render");lib._PAGE_EVENT.on("rerender",function(){lib.action.lazy.add()})})();
(function(){lib.kit.newJob("derestrict",function(){lib._PAGE_EVENT.on("beforesearch",function(a){a.data.keyword=="QIYICOM"&&(lib.kit.FlashCall({flashID:"clearSwf",functionName:"notice",parameter:JSON.stringify({type:"derestrict"})}),lib.cookie.set("iplimit","0",720,"/",lib.SITE_DOMAIN))})});lib._PAGE_JOB.add("derestrict")})();
(function(){lib.Class("UserScoreModel",{ns:lib.model,extend:lib.model.Model,construct:function(){this.callsuper();this._model=lib.model({actions:{getScore:{method:"get",params:["uid","pid","cid","ver"],format:"json",encode:!0,passport:!0,url:"user/up.action"},addScore:{method:"get",params:["uid","pid","cid","task","count","sig","ver"],format:"json",encode:!0,passport:!0,url:"task/ct.action"}},url:"http://api.i."+lib.SITE_DOMAIN+"/jifen/services/"})},methods:{addScore:function(a,b){var a=a||{},d=this;
this._model.addScore(a,{success:function(a){d._data.success=!0;d._data.data=a;b(d._data)},failure:function(){d._data.success=!1;b(d._data)}})}}})})();
(function(){lib.kit.newJob("userloginScore",function(){var a=new lib.model.UserScoreModel,b=["login"],d=["9b6ec0f118752033"],e=function(e,f,i){var j=lib.component.login.getUserInfo();if(j&&j.uid){var k={};k.uid=j.uid;k.pid="b6c13e26323c537d";k.cid="afbe8fd3d73448c9";e=="vt"&&(k.count=f.count);k.task=d[b.indexOf(e)];e=["uid","pid","task"].sort();f=0;for(j=e.length;f<j;f++)e[f]+="="+k[e[f]];k.sig=lib.md5(e.join("")+"869393fc8cf93639");k.ver="1.2";a.addScore(k,function(a){i(a)})}},f=function(){var a=
new Date,b=lib.component.login.getUserInfo();b&&b.uid&&(lib.cookie.get("scoredata"+b.uid)&&lib.cookie.get("scoredata"+b.uid)==""+a.getFullYear()+(a.getMonth()+1)+a.getDate()||e("login",{},function(d){d.success&&(a=new Date,lib.cookie.set("scoredata"+b.uid,""+a.getFullYear()+(a.getMonth()+1)+a.getDate(),1))}))};lib.$("#j-login-wrapper")&&setTimeout(function(){lib.$("#j-login-wrapper").html().trim()?(lib.component.login.isLogin()&&f(),lib.component.login.setCallback("login",f)):setTimeout(arguments.callee,
500)},500)});lib._PAGE_JOB.add("userloginScore")})();(function(){lib.Class("FloaterNoPosView",{ns:lib.view,extend:lib.view.FloaterView,methods:{adjustPosition:function(){}}})})();
(function(){lib.kit.newJob("closeAdFloater",function(){var a=new lib.model.FloaterModel,b=new lib.view.FloaterNoPosView,d=new lib.action.Floater(a,b),e=['<div class="hy-tips-k2">','<a data-btn="j-close-btn" class="hy-close" href="#"></a>','<a class="tggg" title="\u8df3\u8fc7\u5e7f\u544a" href="#"></a>','<a class="cdpk" title="\u8d85\u5927\u7247\u5e93" href="#"></a>','<a class="wxxx" title="\u65e0\u7ebf\u4e0b\u8f7d" href="#"></a>','<a class="cqml" title="\u8d85\u6e05\u7801\u6d41" href="#"></a>','<a class="gstd" title="\u9ad8\u901f\u901a\u9053" href="#"></a>',
'<a data-btn="j-buy-btn" class="hy-l-button hy-but02" href="#">','<span class="s0">\u5355\u7247\u70b9\u64ad</span>','<span class="s1">',"<b>19</b>.5\u5143/\u6708 <br><i>\u5c3d\u4eab\u5168\u7ad9\u5c0a\u8d35\u7279\u6743</i>","</span>","</a>",'<p class="hy-lastname">','<span data-ctn="j-total-people">30000</span>\u4eba\u6b63\u5728\u4eab\u53d7\u5947\u827a\u4f1a\u5458\u7279\u6743',"</p>","</div>"],f=d.getFloater(),g=lib.$("#flash"),h,i,j=function(){var a=f.box(),b=g.box();f.pos({left:(b.width-a.width)/
2+b.left,top:(b.height-a.height)/2+b.top})},k=function(){var a=lib.cookie.get("QC012"),a=a?parseInt(a)+parseInt(Math.random()*300):3E4+parseInt(Math.random()*300);lib.cookie.set("QC012",a,8760,"/",lib.SITE_DOMAIN);i.html(a)};lib._PAGE_EVENT.on("swf_purchaseLayer",function(){d.show({html:e.join("")});h=f.down("a[data-btn=j-close-btn]");i=f.down("span[data-ctn=j-total-people]");f.down("a[data-btn=j-buy-btn]").attr("href",["http://serv.vip.iqiyi.com/order/preview.action?pid=a0226bd958843452","aid="+
info.albumId||"","qy_fr=P-JMP-0102",version=1].join("&"));h.on("click",function(a){lib.Event.stop(a);d.hide();lib.kit.FlashCall({flashID:"flash",functionName:"closePurchaseLayer"})});j();k();lib.kit.FlashCall({flashID:"flash",functionName:"showPurchaseLayer"})})});lib._PAGE_JOB.add("closeAdFloater")})();
lib.kit.newJob("updateRecordsTitle",function(a){var b=lib.$("*[j-updaterecord=title]");if(b){var d=lib.$("#j-playHistory");lib._PAGE_EVENT.on("updateRecords",function(e){if(e)(e=e.data)&&e.length>0?(b.css("display",""),d&&a.jiLu&&d.addClass("jilu")):(b.hide(),d&&a.jiLu&&d.removeClass("jilu"))})}});
lib.kit.newJob("updateRecordsIcon",function(){var a=lib.$("*[j-updaterecord=icon]"),b=a&&a.down("*[j-iconnum=true]");a&&b&&(lib._PAGE_EVENT.on("updateRecords",function(d){if(d&&!lib.cookie.get("noUpdateRecordIcon"))(d=d.data)&&d.length>0?(b.html(d.length>99?"99+":d.length),a.css("display","")):(b.html(0),a.hide())}),lib._PAGE_EVENT.on("noUpdateRecordIcon",function(){b.html(0);a.hide();lib.cookie.set("noUpdateRecordIcon","true",0,"/",lib.SITE_DOMAIN)}))});
lib.kit.newJob("updateRecordsTip",function(){var a=lib.component.login.getUserInfo(),b=lib.cookie.get("firstRecordTip"+a.uid),d=lib.$("*[j-updaterecord=title]");if(d&&!b){var e=lib.$("#j-header"),b=d.attr("j-firsttip");if(e&&d&&b=="has"){var f=null,g=function(){if(!lib.cookie.get("firstRecordTip"+a.uid)){var b=d.box(),g=e.box(),g=g.top+g.height,j=b.left+b.width;f.css("display","");f.css("top",g-7+"px");f.css("left",j-f.box().width+143+"px");lib.kit.UnderFrame.show("recordtipid",{top:b.bottom+8,height:f.box().height-
12,width:f.box().width-2})}};lib._PAGE_EVENT.on("updateRecords",function(b){if(b){var b=b.data,d=lib.cookie.get("firstRecordTip"+a.uid);b&&b.length>0&&!d&&(lib.$(document.body).html("beforeend",'<div id="recordtipid" class="updateBox" style="display:none;"><div class="gxDesc"><p>\u60a8\u770b\u8fc7\u7684\u5185\u5bb9\u6709\u66f4\u65b0\u5566</p><a href="javascript:" j-recordtip="closebtn" title="\u5173\u95ed" class="x"></a><p class="toZd"><a href="javascript:" j-recordtip="closebtn">\u77e5\u9053\u4e86</a><a href="javascript:" j-recordtip="lookbtn">\u53bb\u770b\u770b&gt;&gt;</a></p></div></div>'),
f=lib.$("#recordtipid"),g(),lib.$(window).on("resize",g),f.down("*[j-recordtip=closebtn]").on("click",function(a){lib.Event.stop(a);f.hide();lib.kit.UnderFrame.hide("recordtipid")}),f.down("*[j-recordtip=lookbtn]").on("click",function(a){lib.Event.stop(a);lib._PAGE_EVENT.fire({type:"tipGoLook"})}),lib._PAGE_EVENT.on("showUpdateRecordFloater",function(){f.hide();lib.kit.UnderFrame.hide("recordtipid")}),lib.cookie.set("firstRecordTip"+a.uid,"true",0,"/",lib.SITE_DOMAIN))}});lib._PAGE_EVENT.on("login",
function(){f&&(f.hide(),lib.kit.UnderFrame.hide("recordtipid"))});lib._PAGE_EVENT.on("logout",function(){f&&(f.hide(),lib.kit.UnderFrame.hide("recordtipid"))})}}});
(function(){lib.Class("UpdateRecordFloater",{ns:lib.action,extend:lib.action.Adapter,construct:function(a,b){this.callsuper(a,b)},methods:{init:function(){this.listenToEvent()},listenToEvent:function(){var a=this;lib._PAGE_EVENT.on("updateRecords",function(b){b&&a.syncSet(b)});lib._PAGE_EVENT.on("tipGoLook",function(){a._view.showFloater()});lib._PAGE_EVENT.on("showUpdateRecordFloater",function(){a._view.doShowUpdateRecordFloater()})}}})})();
(function(){lib.Class("UpdateRecordFloaterModel",{ns:lib.model,extend:lib.model.Model,construct:function(a){this.callsuper(a)},properties:{urlParams:"?type=gengxintixingv14&jsuid="+lib.cookie.get("QC006")+"&weid="+window.webEventID+"&flshuid="+lib.cookie.get("QC005")},methods:{set:function(a){var a=a.data,b=[];if(a){for(var d=0,e=a.length;d<e;d++)b.push(this.format(Object.extend({},a[d])));Object.extend(this._data,{data:b})}return this._data},format:function(a){this.formatName(a);this.formatPlayState(a);
this.formatUrl(a);this.formatUpdateTitle(a);return a},formatName:function(a){a.channelId==6||a.channelId==14?(a.shortVideoName=a.source.trancate(32),a.titleName=a.source):a.channelId==10?(a.shortVideoName=a.tvName.trancate(32),a.titleName=a.tvName):(a.shortVideoName=a.videoName.trancate(32),a.titleName=a.videoName)},formatPlayState:function(a){a.playCtl="\u73b0\u5728\u89c2\u770b";a.playNext="";a.spliter="";if(a.channelId==2||a.channelId==3||a.channelId==4){var b=isNaN(a.videoPlayTime)?-1:parseInt(a.videoPlayTime,
10);a.playCtl=b==0?"\u91cd\u65b0\u89c2\u770b":"\u7ee7\u7eed\u89c2\u770b";if(a.nextTvid&&a.nextVideoUrl)a.playNext="\u4e0b\u4e00\u96c6",a.spliter="|";a.currentUrl=a.videoUrl}if(a.channelId==6||a.channelId==14)b=isNaN(a.videoPlayTime)?-1:parseInt(a.videoPlayTime,10),a.playCtl=b==0?"\u91cd\u65b0\u89c2\u770b":"\u7ee7\u7eed\u89c2\u770b",a.playNext="\u6700\u65b0",a.spliter="|",a.nextVideoUrl=a.vurl,a.currentUrl=a.videoUrl;if(a.channelId==7)a.currentUrl=a.vurl;if(a.channelId==10)a.currentUrl=a.vurl},formatUrl:function(a){a.updateVideoUrl=
a.videoUrl?a.videoUrl+this.urlParams:"javascript:void(0)";a.updateCurrentUrl=a.currentUrl?a.currentUrl+this.urlParams:"javascript:void(0)";a.updateVUrl=a.vurl?a.vurl+this.urlParams:"javascript:void(0)";a.updateNextUrl=a.nextVideoUrl?a.nextVideoUrl+this.urlParams:"javascript:void(0)";if(a.channelId==10)a.updateVideoUrl=a.updateVUrl},formatUpdateTitle:function(a){if(a.channelId==2||a.channelId==3||a.channelId==4)a.updateTitle="\u66f4\u65b0\u81f3\u7b2c"+a.mpd+"\u96c6";else if(a.channelId==6||a.channelId==
14){var b=a.mpd+"";a.updateTitle=b.length==8?"\u66f4\u65b0\u81f3\u7b2c"+b.substring(0,4)+"-"+b.substring(4,6)+"-"+b.substring(6,8)+"\u671f":b}else a.updateTitle=a.channelId==10?"\u6b63\u7247\u4e0a\u6620":a.channelId==7?"\u4e8b\u4ef6\u66f4\u65b0":""}}})})();
(function(a){var b=!1,d=null,e,f,g,h,i,j=207,k=2;lib.component.UpdateRecordPopup={init:function(b,d,h,i){var m=this;j=h;k=i;(new lib.kit.Monitor(function(){e=b;f=d;g=lib.$("#j-header");if(!e||!f||!g)return!1;e.on("click",m._clickHandler.bind(m));lib.$(a).on("resize",m._pos.bind(m));lib.ipad||(e.on("mouseover",m._userOver.bind(m)),e.on("mouseout",m._userOut.bind(m)),f.on("mouseover",m._popupOver.bind(m)),f.on("mouseout",m._popupOut.bind(m)))},{time:100})).start()},destroy:function(){e&&(e.un("click",
this._clickHandler.bind(this)),e.un("mouseover",this._userOver.bind(this)),e.un("mouseout",this._userOut.bind(this)),f.un("mouseover",this._popupOver.bind(this)),f.un("mouseout",this._popupOut.bind(this)))},_show:function(){f.show();this._pos();lib._PAGE_EVENT.fire({type:"showUpdateRecordFloater"});b=!0;lib.kit.slog.log({type:"gengxintixingv14",jsuid:lib.cookie.get("QC006"),flshuid:lib.cookie.get("QC005"),weid:a.webEventID,flag:"divshow"},"http://msg.video.qiyi.com/tmpstats.gif")},_pos:function(){h=
e.box();i=h.left+h.width;f.css("top",h.bottom+k+"px");f.css("left",i-f.box().width+j+"px");setTimeout(function(){lib.kit.UnderFrame.show("j-updaterecordfloat",{top:h.bottom+8,height:f.box().height-6})},10)},_hide:function(){f.hide();lib.kit.UnderFrame.hide("j-updaterecordfloat");b=!1},_clickHandler:function(a){lib.Event.preventDefault(a);lib.ipad&&(b?(this._hide(),lib.action.ipadPlayer&&lib.action.ipadPlayer.showVideo()):(this._show(),lib.action.ipadPlayer&&lib.action.ipadPlayer.hideVideo()))},_userOver:function(){d!==
null&&clearTimeout(d);b!==!0&&this._show()},_userOut:function(){var a=this;b===!0&&(d=setTimeout(function(){a._hide()},100))},_popupOver:function(){d!==null&&clearTimeout(d)},_popupOut:function(){var a=this;b===!0&&(d=setTimeout(function(){a._hide()},100))}}})(window);
(function(){lib.Class("UpdateRecordFloaterView",{ns:lib.view,extend:lib.view.View,properties:{titleCon:lib.$("*[j-updaterecord=title]"),noUpdateInfo:'<div class="none_jilu gxtx_hot"><p>\u8fd1\u671f\u6ca1\u6709\u60a8\u5173\u6ce8\u7684\u5267\u96c6\u8282\u76ee\u66f4\u65b0\u3002</p><p><a href="http://list.iqiyi.com">\u67e5\u770b\u70ed\u95e8\u5267\u96c6\uff0c\u53d1\u73b0\u7cbe\u5f69</a></p></div>',liTemplate:new lib.Template('<li><div class="row"><h2 class="tit_other"><a title="${titleName}" href="${updateVideoUrl}">${shortVideoName}</a></h2><div class="row row_new"><span class="info">(<a href="${updateVUrl}" title="${updateTitle}">${updateTitle}</a>)</span><span class="info_R_New"><a class="continue" href="${updateCurrentUrl}" title="${playCtl}">${playCtl}</a><em>${spliter}</em><a class="continue" href="${updateNextUrl}" title="${playNext}">${playNext}</a></span></div></div></li>')},
methods:{init:function(){this.initFloaterInfo();this.initFloater();this.bindEvent()},initFloaterInfo:function(){this.floaterInfo=['<div id="j-updaterecordfloat" class="gui-PlayLogSuggest" style="position: absolute; top: 0; left:0; z-index: 99999; display: none;"><div class="hd"><a class="close" j-recordfloat="close" href="#">\u5173\u95ed</a><div style="text-align:right; float:right; line-height:47px;"><a href="#" j-recordfloat="notip" style="">\u672c\u6b21\u8bbf\u95ee\u4e0d\u518d\u63d0\u9192</a><span style="padding-left:5px; padding-right:8px;">|</span></div></div><div j-recordfloat="infocon" class="bd">',
this.noUpdateInfo,'</div><div j-recordfloat="logincon" class="ft"><div class="loaded gxtx_ft" style="display:block"><a href="#" onclick="return false" class="nologin"></a><a class="gxtx_login" j-delegate="login" href="http://passport.iqiyi.com/user/login.php">\u767b\u5f55</a>\u7231\u5947\u827a\uff0c\u4eab\u53d7\u5404\u5e73\u53f0\u4e00\u81f4\u4f53\u9a8c</div></div></div>'].join("")},initFloater:function(){lib.$(document.body).html("beforeend",this.floaterInfo);this.floaterCon=lib.$("#j-updaterecordfloat");
this.initPopup();this.closeBtn=this.floaterCon.down("*[j-recordfloat=close]");this.noTipBtn=this.floaterCon.down("*[j-recordfloat=notip]");this.infoCon=this.floaterCon.down("*[j-recordfloat=infocon]");this.loginCon=this.floaterCon.down("*[j-recordfloat=logincon]");this.loginBtn=this.floaterCon.down("*[j-delegate=login]")},initPopup:function(){lib.component.UpdateRecordPopup.init(this.titleCon,this.floaterCon,207,2)},bindEvent:function(){this.closeBtn.on("click",this.doCloseBtn.bind(this));this.noTipBtn.on("click",
this.doNoTipBtn.bind(this));if(this.loginBtn)this.loginBtn.on("click",this.doLoginBtn.bind(this))},doCloseBtn:function(a){lib.Event.stop(a);this.floaterCon.hide()},doNoTipBtn:function(a){lib.Event.stop(a);this.doCloseBtn(a);lib._PAGE_EVENT.fire({type:"noUpdateRecordIcon"});lib.kit.slog.log({type:"gengxintixingv14",jsuid:lib.cookie.get("QC006"),flshuid:lib.cookie.get("QC005"),weid:window.webEventID,flag:"dontshow"},"http://msg.video.qiyi.com/tmpstats.gif")},doLoginBtn:function(){lib.component.UpdateRecordPopup._hide()},
doInfoConMouseEnter:function(a){a=a||window.event;(a.currentTarget||a.srcElement).className="on"},doInfoConMouseLeave:function(a){a=a||window.event;(a.currentTarget||a.srcElement).className=""},update:function(a){var b=this.infoCon.down("li");b&&(b.un("mouseenter"),b.un("mouseleave"));a=a.data;b=[];if(a&&a.length>0){for(var d=0,e=a.length;d<e;d++)b.push(this.liTemplate.evaluate(a[d]));this.infoCon.html('<div style="position:relative;overflow:hidden;"><ul class="'+(a.length>4?"max":"")+'">'+b.join("")+
"</ul></div>");if(b=this.infoCon.down("li"))b.on("mouseenter",this.doInfoConMouseEnter.bind(this)),b.on("mouseleave",this.doInfoConMouseLeave.bind(this))}else this.infoCon.html(this.noUpdateInfo)},showFloater:function(){lib.component.UpdateRecordPopup._show()},doShowUpdateRecordFloater:function(){lib.component.login.isLogin()?this.loginCon.hide():this.loginCon.css("display","")}}})})();
(function(){lib.Class("UpdateRecordFloaterHomeView",{ns:lib.view,extend:lib.view.UpdateRecordFloaterView,methods:{initFloaterInfo:function(){this.floaterInfo=['<div id="j-updaterecordfloat" class="gui-PlayLogSuggest_wrap" style="position: absolute; top: 0; left:0; z-index: 99999; display: none;"><div class="gui-PlayLogSuggest"><div class="jiao"></div><div class="hd"><a class="close" j-recordfloat="close" href="#">\u5173\u95ed</a><div style="text-align:right; float:right; line-height:47px;"><a href="#" j-recordfloat="notip" style="">\u672c\u6b21\u8bbf\u95ee\u4e0d\u518d\u63d0\u9192</a><span style="padding-left:5px; padding-right:8px;">|</span></div></div><div j-recordfloat="infocon" class="bd">',
this.noUpdateInfo,'</div><div j-recordfloat="logincon" class="ft"><div class="loaded gxtx_ft" style="display:block"><a href="#" onclick="return false" class="nologin"></a><a class="gxtx_login" j-delegate="login" href="http://passport.iqiyi.com/user/login.php">\u767b\u5f55</a>\u7231\u5947\u827a\uff0c\u4eab\u53d7\u5404\u5e73\u53f0\u4e00\u81f4\u4f53\u9a8c</div></div></div></div>'].join("")},initPopup:function(){lib.component.UpdateRecordPopup.init(this.titleCon,this.floaterCon,23,4)}}})})();
(function(){lib.kit.newJob("updateRecordsFloater",function(a){a=a||{};if(lib.$("*[j-updaterecord=title]")){var b=null,b=a.page=="home"?new lib.view.UpdateRecordFloaterHomeView:new lib.view.UpdateRecordFloaterView,a=new lib.model.UpdateRecordFloaterModel;(new lib.action.UpdateRecordFloater(a,b)).init()}})})();
lib.kit.newJob("updateRecordsGetter",function(){function a(a){for(var b=a.target,a=[],f=null,g=0,h=b.length;g<h;g++){if(f=b[g].videoPlayTime)if(f=parseInt(f,10),f<60&&f>0)continue;a.push(b[g].albumId)}lib.kit.util.jsLoad.request("http://dispatcher.video."+lib.SITE_DOMAIN+"/aup/",{CACHE:{varname:"aup",uid:(lib.component.login.isLogin()?lib.component.login.getUserInfo().uid:lib.cookie.get("QC005"))+"/?aid="+a.join(",")+"&cb=aup"},onSuccess:function(a){for(var d=[],f=null,g={},h=null,n=0,p=b.length;n<
p;n++)if(f=b[n],(h=a[f.albumId+""])&&!(h.cid==2&&f.channelId==10)&&!g[h.albumId])Object.extend(f,h),d.push(f),g[h.albumId]=!0;lib._PAGE_EVENT.fire({type:"updateRecords",data:d})},onError:function(){lib._PAGE_EVENT.fire({type:"updateRecords",data:null})},spliter:"0",timeout:5E3})}var b=!1;lib._PAGE_EVENT.on("playHistoryLoaded",function(d){b&&(b=!1,a(d))});lib._PAGE_EVENT.on("updateRecordsTimer",function(){b=!0;lib.action.NewPlayHistory.instance.readHistory(!0)});lib._PAGE_EVENT.on("login",function(){b=
!0;lib.action.NewPlayHistory.instance.readHistory(!0)});lib._PAGE_EVENT.on("logout",function(){b=!0;lib.action.NewPlayHistory.instance.readHistory(!0)})});lib.kit.newJob("updateRecordsTimer",function(){function a(){lib._PAGE_EVENT.fire({type:"updateRecordsTimer"})}setTimeout(function(){a()},500);window.setInterval(a,18E5)});
(function(){lib.kit.newJobs("updateRecords",{updateRecordsTitle:{jiLu:!0},updateRecordsIcon:{},updateRecordsTip:{},updateRecordsFloater:{page:"home"},updateRecordsGetter:{},updateRecordsTimer:{}});lib._PAGE_JOB.add("updateRecords")})();
(function(){lib.kit.newJob("adPlayerGoto",function(){function a(){_isAD=!1;var a=window.open("","fullscreen","top=0,left=0,toolbar=no,menubar=no,scrollbars=no, location=no,status=no");a.focus();a.location=e}function b(){j?(i.show({html:str=['<div id="j-result" class="popGame" ><a data-btn="j-close-btn" class="x" href="javascript:"></a>',AC_Generateobj({align:"middle",height:450,id:"gameswf",width:600},{bgcolor:"#000000",movie:f,wmode:"transparent"},{align:"middle",bgcolor:"#000000",height:450,id:"gameswf",
src:f,width:600,wmode:"transparent"},!0,!0),'<div class="layer" ><a data-btn="j-enter-btn"></a></div></div>'].join("")}),o=k.down("a[data-btn=j-close-btn]"),l=k.down("a[data-btn=j-enter-btn]"),o.on("click",function(){i.hide();_isAD=!1}),l.on("click",function(){i.hide();a();d("clkcoverpg")})):i.show()}function d(a){lib.kit.slog.log({type:"baidugametjl20120919",jsuid:lib.cookie.get("QC006"),qtcurl:location.href,usract:a,ppuid:lib.component.login.getUserInfo().uid},"http://msg.video.qiyi.com/tmpstats.gif")}
var e="",f="",g=new lib.model.FloaterModel,h=new lib.view.FloaterView,i=new lib.action.Floater(g,h),j=!0,k=i.getFloater(),o,l;_isAD=!1;lib.component.login.setCallback("login",function(){_isAD&&(b(),d("loginbydiv"))});lib._PAGE_EVENT.on("loginclose",function(){_isAD&&!lib.component.login.isLogin()&&(_isAD=!1)});lib._PAGE_EVENT.on("swf_adplayergoto",function(b){_isAD=!0;if(b.data.url&&b.data.swfurl)e="http://passport.iqiyi.com/baiduyouxi/loginpop.php?redirectUrl="+b.data.url,f=b.data.swfurl,d("clkpic"),
lib.component.login.isLogin()?a("http://passport.iqiyi.com/baiduyouxi/loginpop.php?redirectUrl="+b.data.url):lib.component.login.show(function(){lib.net.formRequest.request("http://serv.vip."+lib.SITE_DOMAIN+"/order/preview.action",{method:"POST",target:_target,param:{cid:"afbe8fd3d73448c9",pid:"a0226bd958843452",payCard:"0",dt:(new Date).getTime()}})},{regUrl:"http://passport.iqiyi.com/baiduyouxi/loginpop.php?redirectUrl="+encodeURIComponent(encodeURIComponent(b.data.url))}),lib.kit.FlashCall({flashID:"flash",
functionName:"showAdplayerGoto"})})});lib._PAGE_JOB.add("adPlayerGoto")})();
(function(a){var b=a.document;$reg("lib.action",function(){});$reg("qipa.action",function(){});$reg("lib.__callbacks__",function(){});lib.action.thirdPartyLogin=qipa.action.thirdPartyLogin={_cntWindow:null,_loginSucSlog:"",_dlgPopup:function(a,b){lib.Event.preventDefault(b.event);this.showWindow(b.target.href)},showWindow:function(b,e){var f=(screen.height-420)/2,g=(screen.width-520)/2,h=!1;this._loginSucSlog=e?e:{};try{this._cntWindow=a.open(b,"connect_window","height=420, width=520, toolbar =no, menubar=no, scrollbars=yes, resizable=no,top="+
f+",left="+g+", location=no, status=no"),this._cntWindow==null&&(h=!0)}catch(i){h=!0}h&&this._error("blocked")},_success:function(a){this._cntWindow&&this._cntWindow.close();a&&(lib.go(a),this._setBoxSize());if(!a)try{if(this._loginSucSlog&&this._loginSucSlog.param&&this._loginSucSlog.url)this._loginSucSlog.param.ppuid=lib.component.login.getUserInfo().uid||"",lib.kit.slog.log(Object.extend({},this._loginSucSlog.param),this._loginSucSlog.url);parent.lib.component.login.runCallbacks("login");top!==
self&&parent.lib.component.login.dialog.close()}catch(b){}},_setBoxSize:function(){if(self!==top)try{var a=parent.lib.component.login.dialog;a.box.width="532";a.box.height="397";a.setCenter()}catch(b){}},_error:function(a){a=="blocked"&&alert("\u8bf7\u5141\u8bb8\u5f39\u7a97\u9a8c\u8bc1\u7a97\u4f53\u3002")},init:function(){$(b).delegate("baiduoauth",this._dlgPopup.bind(this,"baidu"));$(b).delegate("sinaoauth",this._dlgPopup.bind(this,"sina"));$(b).delegate("oauth",this._dlgPopup.bind(this,""));lib.__callbacks__._oAuthSuccess=
this._success.bind(this);lib.__callbacks__._oAuthError=this._error.bind(this)}}})(window);
(function(){lib.kit.newJob("thirdpartylogin",function(){lib.action.thirdPartyLogin.init();lib._PAGE_EVENT.on("swf_thridpartylogin",function(a){var b={param:{type:"plraftlogsuc",url:window.location.href,flshuid:lib.cookie.get("QC005"),jsuid:lib.cookie.get("QC006")},url:"http://msg.video.qiyi.com/tmpstats.gif"};switch(a.data.value){case "qq":lib.action.thirdPartyLogin.showWindow("http://passport.iqiyi.com/oauth/login.php?isiframe=1&type=4",b);break;case "sina":lib.action.thirdPartyLogin.showWindow("http://passport.iqiyi.com/oauth/login.php?isiframe=1&type=2",
b);break;case "normal":a=function(){lib.kit.slog.log(b.param,b.url)},a.isTemp=!0,lib.component.login.show(a)}})});lib._PAGE_JOB.add("thirdpartylogin")})();
(function(){var a=document.referrer;if(a){var a=new lib.kit.Url(a),a=a.info.host.split(".").slice(-2,-1),b={qq:{title1:"QQ",title2:"QQ",classname:"guest_qq",url:"http://passport."+lib.SITE_DOMAIN+"/oauth/login.php?isiframe=1&type=4"},weibo:{title1:"\u65b0\u6d6a\u5fae\u535a",title2:"\u5fae\u535a",classname:"guest_weibo",url:"http://passport."+lib.SITE_DOMAIN+"/oauth/login.php?isiframe=1&type=2"},renren:{title1:"\u4eba\u4eba\u7f51",title2:"\u4eba\u4eba\u7f51",classname:"guest_ren",url:"http://passport."+
lib.SITE_DOMAIN+"/oauth/login.php?isiframe=1&type=3"}}[a];if(b){var d={type:"snsusrlog20121112",ppuid:lib.component.login.getUserInfo().uid||"",flshuid:lib.cookie.get("QC005"),jsuid:lib.cookie.get("QC006"),sns:a},e=document.createElement("div");e.className="new_add1107";e.style.display=lib.component.login.isLogin()?"none":"";e.innerHTML=['<div class="guest_remind"><div class="guest_wrap"><a href="#" class="guest_close"></a><h1>',"<span>\u4f7f\u7528\u60a8\u7684"+b.title1+"\u8d26\u53f7\u767b\u5f55\u7231\u5947\u827a\uff0c\u5373\u523b\u5c0a\u4eab"+
b.title2+"\u7528\u6237\u4e13\u5c5e\u670d\u52a1\u3002</span>",'<a href="'+b.url+'" class="guest_login '+b.classname+'"></a>',"</h1></div></div>"].join("");lib.$(e).down("a.guest_close").on("click",function(a){lib.Event.preventDefault(a);e.style.display="none";a=Object.extend({act:"clkclose",weid:window.webEventID},d);lib.kit.slog.log(a,"http://msg.video.qiyi.com/tmpstats.gif")});lib.$(e).down(".guest_login").on("click",function(a){lib.Event.stop(a);a=Object.extend({act:"clklogin",weid:window.webEventID},
d);lib.kit.slog.log(a,"http://msg.video.qiyi.com/tmpstats.gif");lib.action.thirdPartyLogin.showWindow(b.url,{param:Object.extend({act:"loginsucc",weid:window.webEventID},d),url:"http://msg.video.qiyi.com/tmpstats.gif"})});setTimeout(function(){lib.kit.slog.log(Object.extend({act:"showdiv",weid:window.webEventID},d),"http://msg.video.qiyi.com/tmpstats.gif")},2E3);document.body.insertBefore(e,document.body.childNodes[0]);lib._PAGE_EVENT.on("login",function(){e.style.display="none"})}}})();
(function(){window.__LT__&&(__LT__.j.newbase={start:__LT__.j.newbase-__LT__.l.begin,cost:new Date-__LT__.j.newbase})})();
